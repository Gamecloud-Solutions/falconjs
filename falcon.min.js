(function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D=[].slice,E={}.hasOwnProperty,F=function(a,b){function c(){this.constructor=a}for(var d in b)E.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};o=function(a){return null!=a&&"[object Object]"===Object.prototype.toString.call(a)},l=function(a){return null!=a&&"[object Function]"===Object.prototype.toString.call(a)},i=function(a){return null!=a&&"[object Boolean]"===Object.prototype.toString.call(a)},h=function(a){return null!=a&&"[object Array]"===Object.prototype.toString.call(a)},p=function(a){return null!=a&&"[object String]"===Object.prototype.toString.call(a)},n=function(a){return null!=a&&"[object Number]"===Object.prototype.toString.call(a)},m=function(a){return n(a)&&a!==a},k=function(a){var b,c;if(null==a)return!0;if(p(a)||h(a))return 0===a.length;if(o(a)){for(b in a)return c=a[b],!1;return!0}return!1},j="object"==typeof HTMLElement?function(a){return a instanceof HTMLElement}:function(a){return null!=a&&1===a.nodeType&&"string"==typeof a.nodeName},t=function(a){return a.replace(/^\s+/,"").replace(/\s+$/,"")},s=function(a,b){return 0===a.indexOf(b)},r=function(a){var b,c;c=[];for(b in a)c.push(b);return c},f=function(a,b){var c,d;null==a&&(a={}),o(b)||(b={});for(c in b)d=b[c],a[c]=d;return a},g=function(a,b){var c,d;for(c in a)if(d=a[c],d===b)return c;return void 0},e=function(a){var b,c,d;if(!o(a))return a;if(a instanceof Date)return new Date(a.getTime());if(a instanceof RegExp)return b="",null!=a.global&&(b+="g"),null!=a.ignoreCase&&(b+="i"),null!=a.multiline&&(b+="m"),null!=a.sticky&&(b+="y"),new RegExp(a.source,b);d=new a.constructor;for(c in a)d[c]=e(a[c]);return d},d=function(a){var b,c,d,e,f;for(c={},e=0,f=a.length;f>e;e++)b=a[e],c[b]=!0;return function(){var a;a=[];for(b in c)d=c[b],a.push(b);return a}()},c=function(a,b){var c,d,e,f;if(!h(a))return[];for(h(b)||(b=[b]),d=0,f=b.length;f>d;d++)c=b[d],a=function(){var b,d,f;for(f=[],b=0,d=a.length;d>b;b++)e=a[b],e!==c&&f.push(e);return f}();return a},y=null,this.Falcon=b={version:"0.10.0",applicationElement:"body",baseApiUrl:"",baseTemplateUrl:"",cache:!0,deferEvaluation:!0,apply:function(a,c,d){var e;return l(c)&&(e=[d,c],c=e[0],d=e[1]),null==c&&(c=b.applicationElement),y(function(){var b;return j(c)||(p(c)||(c=""),c=t(c),k(c)&&(c="body"),c=null!=(b=document.querySelectorAll(c)[0])?b:document.body),c.setAttribute("data-bind","view: $data"),ko.applyBindings(ko.observable(a),c),l(d)?d():void 0}),b},isModel:function(a){return null!=a&&a instanceof b.Model},isCollection:function(a){return null!=a&&a instanceof b.Collection},isView:function(a){return null!=a&&a instanceof b.View},isDataObject:function(a){return null!=a&&(a instanceof b.Model||a instanceof b.Collection)},isFalconObject:function(a){return null!=a&&a instanceof b.Object},addBinding:function(a,b,c){var d;return i(b)&&(d=[c,b],b=d[0],c=d[1]),l(b)&&(b={update:b}),ko.bindingHandlers[a]=b,c&&(ko.virtualElements.allowedBindings[a]=!0),ko.bindingHandlers[a]},getBinding:function(a){return ko.bindingHandlers[a]}},function(){var a,c,d;return d=[],y=function(a){return l(a)?d.push(a):void 0},c=function(){var a,b,c;for(y=function(a){return l(a)?a():void 0},b=0,c=d.length;c>b;b++)a=d[b],a();return d=null},document.addEventListener?document.addEventListener("DOMContentLoaded",a=function(){return c(),document.removeEventListener("DOMContentLoaded",a,!1)},!1):document.attachEvent&&document.attachEvent("readystatechange",a=function(){return"complete"===document.readyState?(c(),document.detachEvent("readystatechange",a)):void 0}),document.createElement("template"),y(function(){return b.View.cacheTemplates()})}(),b.Object=function(){function a(){var a,d,f,g,i,j,k;if(this.__falcon_object__events__={},this.__falcon_object__cid__=c++,o(this.defaults)){f=this.defaults;for(a in f)d=f[a],this[a]=l(d)?d.apply(this,arguments):o(d)?e(d):h(d)?d.slice(0):d}if(o(this.observables)){g=this.observables;for(a in g)d=g[a],this[a]=l(d)?ko.computed({read:d,owner:this,deferEvaluation:null!=(i=b.deferEvaluation)?i:!0}):o(d)&&("read"in d||"write"in d)?ko.computed({read:d.read,write:d.write,owner:null!=(j=d.owner)?j:this,deferEvaluation:null!=(k=b.deferEvaluation)?k:!0,disposeWhen:d.disposeWhen,disposeWhenNodeIsRemoved:d.disposeWhenNodeIsRemoved}):h(d)?ko.observableArray(d.slice(0)):ko.observable(d)}}var c;return c=0,a.prototype.observables=null,a.prototype.defaults=null,a.extend=function(a,b){var c,d,e,f,g;f=this,d=a&&a.hasOwnProperty("constructor")?a.constructor:function(){return f.apply(this,arguments)};for(e in f)g=f[e],d[e]=g;for(e in b)g=b[e],d[e]=g;c=function(){this.constructor=d},c.prototype=f.prototype,d.prototype=new c;for(e in a)g=a[e],d.prototype[e]=g;return d.__super__=f.prototype,d},a.prototype.__falcon_object__events__=null,a.prototype.__falcon_object__cid__=null,a.prototype.on=function(a,b,c){var d;return p(a)&&l(b)?(null==c&&(c=this),a=t(a).toLowerCase(),k(a)?this:((null!=(d=this.__falcon_object__events__)[a]?(d=this.__falcon_object__events__)[a]:d[a]=[]).push({callback:b,context:c}),this)):this},a.prototype.off=function(a,b){var c;return p(a)?(a=t(a).toLowerCase(),k(a)||null==this.__falcon_object__events__[a]?this:(l(b)?(this.__falcon_object__events__[a]=function(){var d,e,f,g;for(f=this.__falcon_object__events__[a],g=[],d=0,e=f.length;e>d;d++)c=f[d],c.callback!==b&&g.push(c);return g}.call(this),this.__falcon_object__events__[a].length<=0&&(this.__falcon_object__events__[a]=null)):this.__falcon_object__events__[a]=null,this)):this},a.prototype.has=function(a,b){var c,d,e,f;if(!p(a))return!1;if(a=t(a).toLowerCase(),k(a)||null==this.__falcon_object__events__[a])return!1;if(null!=this.__falcon_object__events__[a]&&!l(b))return!0;for(f=this.__falcon_object__events__[a],d=0,e=f.length;e>d;d++)if(c=f[d],c.callback===b)return!0;return!1},a.prototype.trigger=function(){var a,b,c,d,e,f;if(b=arguments[0],a=2<=arguments.length?D.call(arguments,1):[],!p(b))return this;if(b=t(b).toLowerCase(),k(b)||null==this.__falcon_object__events__[b])return this;for(f=this.__falcon_object__events__[b],d=0,e=f.length;e>d;d++)c=f[d],c.callback.apply(c.context,a);return this},a}(),b.Model=function(a){function c(a,d){var e,f;return c.__super__.constructor.apply(this,arguments),a=ko.unwrap(a),d=ko.unwrap(d),null!=d&&!b.isModel(d)&&b.isModel(a)&&(e=[a,d],d=e[0],a=e[1]),null==d&&b.isModel(a)&&(f=[a,d],d=f[0],a=f[1]),this.parent=d,this.initialize(a),k(a)||this.fill(a),this}return F(c,a),c.extend=b.Object.extend,c.prototype.id=null,c.prototype.url=null,c.prototype.parent=null,c.prototype.initialize=function(){},c.prototype.get=function(a){return p(a)?ko.unwrap(this[a]):thisundefined},c.prototype.set=function(a,b){var c,d;if(o(a)){for(c in a)d=a[c],this.set(c,d);return this}return p(a)?(ko.isObservable(this[a])?this[a](b):this[a]=b,this):this},c.prototype.toggle=function(a){return this.set(a,!this.get(a))},c.prototype.increment=function(a){return this.set(a,this.get(a)+1),this},c.prototype.decrement=function(a){return this.set(a,this.get(a)-1),this},c.prototype.parse=function(a){return a},c.prototype.fill=function(a){var c,d,e,f;if((n(a)||p(a))&&(a={id:a}),!o(a))return this;if(k(a))return this;d={},f=b.Model.prototype;for(c in f)e=f[c],"id"!==c&&"url"!==c&&(d[c]=!0);for(c in a)e=a[c],d[c]||(e=ko.unwrap(e),b.isModel(this[c])?b.isModel(e)?this[c]=e:this[c].fill(e):b.isCollection(this[c])?b.isCollection(e)?this[c]=e:this[c].fill(e):ko.isWriteableObservable(this[c])?this[c](e):this[c]=e);return this},c.prototype.unwrap=function(){var a,c,d;c={};for(a in this)d=this[a],"id"!==a&&a in b.Model.prototype||(c[a]=b.isDataObject(d)?d.unwrap():d);return c},c.prototype.serialize=function(a){var c,d,e,f,g,i,j;if(e={},null==a?a=function(){var a;a=[];for(c in this)"id"!==c&&c in b.Model.prototype||a.push(c);return a}.call(this):p(a)&&(a=t(a).split(",")),h(a)){for(d={},i=0,j=a.length;j>i;i++)c=a[i],d[c]=null;a=d}if(!o(a))return e;for(c in a)f=a[c],g=this[c],b.isDataObject(g)?e[c]=g.serialize(f):ko.isObservable(g)?e[c]=ko.unwrap(g):l(g)||(e[c]=g);return e},c.prototype.makeUrl=function(a,c,d){var e,f,g,h,i,j,k;return j=l(this.url)?this.url():this.url,p(j)||(j=""),j=t(j),p(a)||(a=""),a=a.toUpperCase(),"GET"!==a&&"PUT"!==a&&"POST"!==a&&"DELETE"!==a&&(a="GET"),void 0===d&&(p(c)||n(c))&&(k=[d,c],c=k[0],d=k[1]),c=void 0!==c?c:this.parent,e="",i=j.lastIndexOf("."),i>-1&&(e=j.slice(i),j=j.slice(0,i)),s(j,"/")||(j="/"+j),b.isModel(c)?(h=c.makeUrl(),f=h.lastIndexOf("."),g=h.lastIndexOf("/"),f>g&&(f>-1&&(h=h.slice(0,f)),h=t(h)),j=""+h+j):p(b.baseApiUrl)&&(j=""+b.baseApiUrl+j),("GET"===a||"PUT"===a||"DELETE"===a)&&("/"!==j.slice(-1)&&(j+="/"),j+=null!=d?d:this.get("id")),j=j.replace(/([^:])\/\/+/gi,"$1/").replace(/^\/\//gi,"/"),""+j+e},c.prototype.validate=function(){return!0},c.prototype.sync=function(a,c,d){var e,f,g,j,m,n,q=this;return l(c)&&(c={complete:c}),p(c)&&(c={attributes:t(c).split(",")}),h(c)&&(c={attributes:c}),o(c)||(c={}),o(c.data)||(c.data=null),p(c.dataType)||(c.dataType="json"),p(c.contentType)||(c.contentType="application/json"),l(c.success)||(c.success=function(){}),l(c.complete)||(c.complete=function(){}),l(c.error)||(c.error=function(){}),b.isModel(c.parent)||null===c.parent||(c.parent=this.parent),null==c.attributes&&(c.attributes=null),o(c.params)||(c.params={}),i(c.fill)||(c.fill=!0),o(c.headers)||(c.headers={}),a=t(p(a)?a.toUpperCase():"GET"),"GET"!==a&&"POST"!==a&&"PUT"!==a&&"DELETE"!==a&&(a="GET"),c.type=a,"PUT"!==a&&"POST"!==a||this.validate(c)?(null!==c.data||"POST"!==a&&"PUT"!==a||(c.data=this.serialize(c.attributes)),e=null===c.data?"":JSON.stringify(c.data),d=null!=(m=null!=d?d:c.context)?m:this,g=null!=(n=c.url)?n:this.makeUrl(a,c.parent),k(c.params)||(g.indexOf("?")>-1||(g+="?"),g+=function(){var a,b;a=c.params,b=[];for(f in a)j=a[f],b.push(""+f+"="+j);return b}().join("&")),$.ajax({type:a,url:g,data:e,dataType:c.dataType,contentType:c.contentType,cache:b.cache,headers:c.headers,success:function(b,e,f){var g;switch(p(b)&&(b=JSON.parse(b)),null==b&&p(f.responseText)&&(b=JSON.parse(f.responseText)),null==b&&(b={}),g=q.parse(b,c,f),c.fill&&q.fill(g,c),a){case"GET":q.trigger("fetch",g);break;case"POST":q.trigger("create",g);break;case"PUT":q.trigger("save",g);break;case"DELETE":q.trigger("destroy",g)}return c.success.call(d,q,b,e,f)},error:function(a){var b,e;e=a.responseText;try{p(e)&&(e=JSON.parse(e))}catch(f){b=f}return c.error.call(d,q,e,a)},complete:function(a,b){return c.complete.call(d,q,a,b)}})):void 0},c.prototype.fetch=function(a,b){return this.sync("GET",a,b)},c.prototype.create=function(a,b){return this.sync("POST",a,b)},c.prototype.save=function(a,b){return this.isNew()?this.create(a,b):this.sync("PUT",a,b)},c.prototype.destroy=function(a,b){return this.sync("DELETE",a,b)},c.prototype.equals=function(a){var c,d;return a=ko.unwrap(a),b.isModel(a)?(c=this.get("id"),d=a.get("id"),null!=c&&null!=d?a.get("id")===this.get("id"):a===this):n(a)||p(a)?a===this.get("id"):!1},c.prototype.mixin=function(a){var c,d,e,f=this;o(a)||(a={});for(c in a)d=a[c],b.isDataObject(this[c])?this[c].mixin(d):ko.isObservable(d)?this[c]=ko.observable(null!=(e=this[c])?e:ko.unwrap(d)):l(d)?!function(){var a;return a=d,f[c]=function(){var b;return b=1<=arguments.length?D.call(arguments,0):[],a.call.apply(a,[f,f].concat(D.call(b)))}}():null==this[c]&&(this[c]=d);return this},c.prototype.clone=function(a,c){var d;return(null===a||b.isModel(a))&&(d=[void 0,a],a=d[0],c=d[1]),null===c||b.isModel(c)||(c=this.parent),new this.constructor(this.serialize(a),c)},c.prototype.isNew=function(){return null==this.get("id")},c}(b.Object),b.View=function(a){function c(){var a,e,f,g,h,i=this;return c.__super__.constructor.apply(this,arguments),e=this.makeUrl(),this._is_rendered=!1,this.is_loaded=ko.observable(!1),this.__falcon_view__child_views__=[],f=function(){return i.__falcon_view__loaded_url__=e,i.is_loaded(!0)},this.initialize.apply(this,arguments),k(e)||e in d?f():s(e,"#")?(a=null!=(g=null!=(h=document.getElementById(e.slice(1)))?h.innerHTML:void 0)?g:"",b.View.cacheTemplate(e,a),f()):$.ajax({url:e,type:"GET",cache:b.cache,error:function(){return console.log("[FALCON] Error Loading Template: '"+e+"'"),i.trigger("error")},success:function(a){return b.View.cacheTemplate(e,a),f()}}),this}var d;return F(c,a),d={},c.cacheTemplate=function(a,c){return p(a)||(a=""),p(c)||(c=""),a=t(a),d[a]=c,b.View},c.cacheTemplates=function(){var a,c,d,e,f,g;for(d=Array.prototype.slice.call(document.getElementsByTagName("template")),e=0,f=d.length;f>e;e++)c=d[e],a=c.getAttribute("id"),null!=a&&b.View.cacheTemplate("#"+a,c.innerHTML),null!=(g=c.parentNode)&&g.removeChild(c);return b.View},c.resetCache=function(){return d={},b.View},c.extend=b.Object.extend,c.prototype.url=null,c.prototype.is_loaded=!1,c.prototype._is_rendered=!1,c.prototype.__falcon_view__child_views__=null,c.prototype.__falcon_view__loaded_url__=null,c.prototype.makeUrl=function(){var a;return null==this.url?null:(a=ko.utils.unwrapObservable(this.url),l(a)&&(a=a()),p(a)||(a=""),a=t(a),"#"===a.charAt(0)?a:("/"!==a.charAt(0)&&(a="/"+a),p(b.baseTemplateUrl)&&(a=""+b.baseTemplateUrl+a),a=a.replace(/([^:])\/\/+/gi,"$1/")))},c.prototype.template=function(){var a;return ko.utils.unwrapObservable(this.is_loaded)?null!=(a=d[this.__falcon_view__loaded_url__])?a:"":""},c.prototype._render=function(){this._is_rendered||(this.display.apply(this,arguments),this._is_rendered=!0)},c.prototype._unrender=function(){var a,b,c,d;if(this._is_rendered){for(d=this.__falcon_view__child_views__,b=0,c=d.length;c>b;b++)a=d[b],a._unrender();this.__falcon_view__child_views__=[],this.dispose.apply(this,arguments),this._is_rendered=!1}},c.prototype._addChildView=function(a){return b.isView(a)?this.__falcon_view__child_views__.push(a):void 0},c.prototype.initialize=function(){},c.prototype.display=function(){},c.prototype.dispose=function(){},c.__falcon_view__viewModel__=null,c.prototype.viewModel=function(){var a,c,d,e=this;if(null!=this.__falcon_view__viewModel__)return this.__falcon_view__viewModel__;d={__falcon_view__addChildView__:function(a){return e._addChildView(a)}};for(a in this)c=this[a],a in b.View.prototype||(l(c)&&!ko.isObservable(c)&&(c=function(){var a;return a=c,function(){var b;return b=1<=arguments.length?D.call(arguments,0):[],a.call.apply(a,[e].concat(D.call(b)))}}()),d[a]=c);return this.__falcon_view__viewModel__=d},c}(b.Object),b.Collection=function(c){function d(a,c){var e,f;d.__super__.constructor.apply(this,arguments),a=ko.unwrap(a),c=ko.unwrap(c),null==c&&b.isModel(a)&&(e=[a,c],c=e[0],a=e[1]),b.isModel(a)&&h(c)&&(f=[a,c],c=f[0],a=f[1]),null!=this.model&&null==this.url&&(this.url=this.model.prototype.url),this.length=ko.observable(0),this.parent=c,this.__falcon_collection__mixins__=[],this.reset(),k(a)||this.fill(a),this.initialize(a)}var e;return F(d,c),d.extend=b.Object.extend,e=function(a){var c,d,e;return b.isModel(a)?(d=a,e=d.get("id"),null!=e?function(a){var c,e;return b.isModel(a)?(c=a.get("id"),e=d.get("id"),c===e):!1}:function(a){return b.isModel(a)?a===d:!1}):n(a)||p(a)?(c=a,function(a){return b.isModel(a)?a.get("id")===c:!1}):a},d.prototype.__falcon_collection__mixins__=null,d.prototype.__falcon_collection__change_count__=0,d.prototype.models=null,d.prototype.model=null,d.prototype.url=null,d.prototype.length=0,d.prototype.parent=null,d.prototype.comparator=null,d.prototype.initialize=function(){},d.prototype.parse=function(a){return a},d.prototype.fill=function(a,c){var d,f,g,i,j,m,n,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J;if(null==this.model)return[];if(null==a&&(a=[]),b.isCollection(a)&&(a=a.models()),ko.isObservable(a)&&(a=ko.unwrap(a)),h(a)||(a=[a]),s=[],o(c)||(c={}),q=c.method,p(q)||(q=""),q=q.toLowerCase(),"replace"!==q&&"append"!==q&&"prepend"!==q&&"insert"!==q&&"merge"!==q&&(q="replace"),d=null!=(H=c.comparator)?H:this.comparator,"replace"!==q&&k(a))return[];for(this.__falcon_collection__change_count__++,g=u=0,y=a.length;y>u;g=++u)for(m=a[g],b.isModel(m)?m instanceof this.model?(s[g]=a[g],null!=this.parent&&(s[g].parent=this.parent)):s[g]=new this.model(m.serialize(),this.parent):s[g]=new this.model(m,this.parent),I=this.__falcon_collection__mixins__,v=0,z=I.length;z>v;v++)n=I[v],s[g].mixin(n);if("replace"===q)G=s;else if("merge"===q)for(G=this.models(),w=0,A=s.length;A>w;w++){for(r=s[w],j=e(r),F=null,x=0,B=G.length;B>x;x++)if(m=G[x],j(m)){F=m;break}F?F.fill(r):G.push(r)}else if("prepend"===q)for(D=s.length-1,G=this.models(),g=E=0,C=s.length;C>E;g=++E)r=s[g],G.unshift(s[D-g]);else"append"===q?(G=this.models(),G=G.concat(s)):"insert"===q&&(i=null!=(J=c.insert_index)?J:-1,G=this.models(),0>i||i>=G.length?G=G.concat(s):(f=G.slice(0,i),t=G.slice(i),G=f.concat(s,t)));return l(d)&&G.sort(d),this.models(G),this.length(this.models().length),s},d.prototype.unwrap=function(){var a,c,d,e;c=[],e=this.models();for(a in e)d=e[a],c[a]=b.isDataObject(d)?d.unwrap():d;return c},d.prototype.serialize=function(a){var c,d,e,f;d=[],f=this.models();for(c in f)e=f[c],d[c]=b.isDataObject(e)?e.serialize(a):e;return d},d.prototype.makeUrl=function(a,c){var d,e,f,g;return g=l(this.url)?this.url():this.url,p(g)||(g=""),g=t(g),p(a)||(a=""),a=a.toUpperCase(),"GET"!==a&&"PUT"!==a&&"POST"!==a&&"DELETE"!==a&&(a="GET"),s(g,"/")||(g="/"+g),c=void 0===c?this.parent:c,b.isModel(c)?(f=c.makeUrl(),d=f.lastIndexOf("."),e=f.lastIndexOf("/"),d>e&&(d>-1&&(f=f.slice(0,d)),f=t(f)),g=""+f+g):p(b.baseApiUrl)&&(g=""+b.baseApiUrl+g),g=g.replace(/([^:])\/\/+/gi,"$1/").replace(/^\/\//gi,"/")},d.prototype.sync=function(a,c,d){var e,f,g,j,m,n,q=this;return l(c)&&(c={complete:c}),p(c)&&(c={attributes:t(c).split(",")}),h(c)&&(c={attributes:c}),o(c)||(c={}),o(c.data)||(c.data=null),p(c.dataType)||(c.dataType="json"),p(c.contentType)||(c.contentType="application/json"),l(c.success)||(c.success=function(){}),l(c.complete)||(c.complete=function(){}),l(c.error)||(c.error=function(){}),b.isModel(c.parent)||null===c.parent||(c.parent=this.parent),null==c.attributes&&(c.attributes=null),o(c.params)||(c.params={}),i(c.fill)||(c.fill=!0),o(c.headers)||(c.headers={}),a=t(p(a)?a.toUpperCase():"GET"),"GET"!==a&&"POST"!==a&&"PUT"!==a&&"DELETE"!==a&&(a="GET"),e=null===c.data?"":JSON.stringify(c.data),d=null!=(m=null!=d?d:c.context)?m:this,g=null!=(n=c.url)?n:t(this.makeUrl(a,c.parent)),k(c.params)||(g.indexOf("?")>-1||(g+="?"),g+=function(){var a,b;a=c.params,b=[];for(f in a)j=a[f],b.push(""+f+"="+j);return b}().join("&")),$.ajax({url:g,type:a,data:e,dataType:c.dataType,contentType:c.contentType,cache:b.cache,headers:c.headers,success:function(b,e,f){var g;return p(b)&&(b=JSON.parse(b)),null==b&&p(f.responseText)&&(b=JSON.parse(f.responseText)),null==b&&(b=[]),g=q.parse(b,c,f),"GET"===a&&(c.fill&&q.fill(g,c),q.trigger("fetch",g)),c.success.call(d,q,b,e,f)},error:function(a){var b,e;e=a.responseText;try{p(e)&&(e=JSON.parse(e))}catch(f){b=f}return c.error.call(d,q,e,a)},complete:function(a,b){return c.complete.call(d,q,a,b)}})},d.prototype.fetch=function(a,b){return this.sync("GET",a,b)},d.prototype.create=function(a,c,d){var e,f,g=this;return null==this.model?null:(o(a)||b.isModel(a)||(a={}),e=b.isModel(a)?a:new this.model(a),l(c)&&(c={success:c}),o(c)||(c={}),l(c.success)||(c.success=function(){}),p(c.method)||(c.method="append"),f=c.success,c.success=function(a){return g.fill(a,c),f.apply(a,arguments)},null==c.parent&&(c.parent=this.parent),null==d&&(d=e),e.create(c,d))},d.prototype.destroy=function(a,c,d){var e,f=this;return null==this.model?null:(a=this.first(ko.unwrap(a)),b.isModel(a)?(l(c)&&(c={success:c}),o(c)||(c={}),l(c.success)||(c.success=function(){}),void 0===c.parent&&(c.parent=this.parent),e=c.success,c.success=function(a){return f.remove(a),e.apply(a,arguments)},a.destroy(c,d)):null)},d.prototype.remove=function(a){var c;return a=ko.unwrap(a),b.isCollection(a)&&(a=a.models()),this.__falcon_collection__change_count__++,c=h(a)?this.models.removeAll(a):this.models.remove(e(a)),k(c)||this.length(this.models().length),this},d.prototype.append=function(a){return this.fill(a,{method:"append"})},d.prototype.prepend=function(a){return this.fill(a,{method:"prepend"})},d.prototype.insert=function(a,b){var c,d;return d=e(b),l(d)?(c=this.indexOf(b),this.fill(a,{method:"insert",insert_index:c})):this.fill(a,{method:"append"})},d.prototype.unshift=function(){return this.prepend.apply(this,arguments)},d.prototype.shift=function(){var a;return a=this.models.shift(),this.length(this.models().length),a},d.prototype.push=function(){return this.append.apply(this,arguments)},d.prototype.pop=function(){var a;return this.__falcon_collection__change_count__++,a=this.models.pop(),this.length(this.models().length),a},d.prototype.sort=function(a){return l(a)?this.models.sort(a):models},d.prototype.at=function(a){var b;return a=parseInt(a),m(a)?null:(b=this.models(),0>a||a>=b.length?null:b[a])},d.prototype.indexOf=function(a){var c,d,f,g,h;if(b.isModel(a))return this.models.indexOf(a);if(d=e(a),!l(d))return-1;for(h=this.models(),c=f=0,g=h.length;g>f;c=++f)if(a=h[c],d(a))return c;return-1},d.prototype.lastIndexOf=function(a){var b,c,d,f,g,h,i;if(d=e(a),!l(d))return-1;for(g=this.models(),f=g.length,b=h=0,i=g.length;i>h;b=++h)if(a=g[b],c=f-b-1,d(g[c]))return c;return-1},d.prototype.each=function(a,b){var c,d,e,f,g,h,i,j;if(!l(a))return this;if(null==b&&(b=this),1===a.length)for(i=this.models(),e=0,g=i.length;g>e;e++)d=i[e],a.call(b,d);else for(j=this.models(),c=f=0,h=j.length;h>f;c=++f)d=j[c],a.call(b,c,d);return this},d.prototype.first=function(a){var b,c,d,f;for(a=e(a),l(a)||(a=function(){return!0}),f=this.models(),c=0,d=f.length;d>c;c++)if(b=f[c],a(b))return b;return null},d.prototype.last=function(a){var b,c,d,f,g,h;for(a=e(a),l(a)||(a=function(){return!0}),f=this.models(),d=f.length,b=g=0,h=f.length;h>g;b=++g)if(c=f[b],c=f[d-b-1],a(c))return c;return null},d.prototype.all=function(){return this.models()},d.prototype.filter=function(a){var b;return a=e(a),l(a)?function(){var c,d,e,f;for(e=this.models(),f=[],c=0,d=e.length;d>c;c++)b=e[c],a(b)&&f.push(b);return f}.call(this):this.models()},d.prototype.any=function(a){var b,c,d,f;if(a=e(a),!l(a))return!1;for(f=this.models(),c=0,d=f.length;d>c;c++)if(b=f[c],a(b))return!0;return!1},d.prototype.without=function(a){var b;return a=e(a),l(a)?function(){var c,d,e,f;for(e=this.models(),f=[],c=0,d=e.length;d>c;c++)b=e[c],a(b)||f.push(b);return f}.call(this):this.models()},d.prototype.pluck=function(a,b){var c,d,e,f,g;for(p(a)||(a=""),i(b)||(b=!0),e=[],d=this.models(),f=0,g=d.length;g>f;f++)c=d[f],null!=c?e.push(b?ko.unwrap(c[a]):c[a]):e.push(void 0);return e},d.prototype.slice=function(a,b){return this.models.slice(a,b)},d.prototype.chain=function(){var b;return b=new a,b.model=this.model,b.fill(this.models()),b},d.prototype.mixin=function(a){var c,d,e,f,g,h,i,j=this;o(a)||(a={}),i={};for(c in a)f=a[c],ko.isObservable(f)?i[c]=ko.observable(ko.unwrap(f)):l(f)?!function(){var a;return a=f,i[c]=function(){var b;return b=1<=arguments.length?D.call(arguments,0):[],a.apply(b[0],[b[0],j].concat(b.slice(1)))},i[c].length=a.length}():i[c]=f;for(e=this.models(),g=0,h=e.length;h>g;g++)d=e[g],b.isDataObject(d)&&d.mixin(i);return this.__falcon_collection__mixins__.push(i),this},d.prototype.clone=function(a,c){var d;return(null===a||b.isModel(a))&&(d=[void 0,a],a=d[0],c=d[1]),null===c||b.isModel(c)||(c=this.parent),new this.constructor(this.serialize(a),c)},d.prototype.reset=function(){return this.__falcon_collection__change_count__++,null!=this.models?this.models([]):this.models=ko.observableArray([]),this.length(0),this},d}(b.Object),a=function(a){function b(){return z=b.__super__.constructor.apply(this,arguments)}return F(b,a),b.prototype.slice=function(){return this.models(b.__super__.slice.apply(this,arguments)),this},b.prototype.sort=function(){return this.models(b.__super__.sort.apply(this,arguments)),this},b.prototype.filter=function(){return this.models(b.__super__.filter.apply(this,arguments)),this},b.prototype.without=function(){return this.models(b.__super__.without.apply(this,arguments)),this},b}(b.Collection),ko.bindingHandlers.view=function(){var a,c,d,e;return d=function(a){return function(){return{data:a,templateEngine:ko.nativeTemplateEngine.instance}}},c=function(a){var c,d;return c={},null==a&&(a={}),c=a instanceof b.View?a.viewModel():ko.utils.unwrapObservable(null!=(d=a.viewModel)?d:{})},a=function(a){var c,d;return c="",null==a&&(a={}),c=a instanceof b.View?a.template():ko.utils.unwrapObservable(null!=(d=a.template)?d:"")},e={controlsDescendantBindings:!0},{init:function(a,c){var d,f,g,h;return h=c(),ko.isSubscribable(h)?(f=ko.utils.unwrapObservable(h),g=h.subscribe(function(a){return b.isView(f)&&f._unrender(),f=a}),ko.utils.domNodeDisposal.addDisposeCallback(a,function(){return b.isView(f)&&f._unrender(),g.dispose()})):b.isView(h)&&ko.utils.domNodeDisposal.addDisposeCallback(a,function(){return h._unrender()}),d=document.createElement("div"),ko.utils.domData.set(a,"__falcon_view__container__",d),new ko.templateSources.anonymousTemplate(a).nodes(d),e},update:function(d,f,g,h,i){var j,l,m,n;return n=f(),ko.isObservable(n)&&(n=n()),h=c(n),m=a(n),null==n&&ko.virtualElements.emptyNode(d),o(n)?(null!=(null!=i?i.__falcon_view__addChildView__:void 0)&&i.__falcon_view__addChildView__(n),j=i.createChildContext(h).extend({$view:h}),k(h)||k(m)?ko.virtualElements.emptyNode(d):(!b.isView(n)||ko.utils.unwrapObservable(n.is_loaded))&&(l=ko.utils.domData.get(d,"__falcon_view__container__"),l.innerHTML=m,ko.renderTemplate(d,j,{},d),b.isView(n)&&n._render()),e):e}}}(),w=function(a){return a=ko.utils.peekObservable(a),(b.isCollection(a)||h(a))&&(a={data:a}),o(a)||(a={}),a.data=ko.utils.unwrapObservable(a.data),b.isCollection(a.data)&&(a.data=a.data.models()),null==a.data&&(a.data=[]),function(){return a}},C=function(a,c){var d,e,f,g;return b.isCollection(c)?(f=ko.utils.domData.get(a,"__falcon_object__cid__"),d=c.__falcon_object__cid__,e=c.__falcon_collection__change_count__,g=ko.utils.domData.get(a,"__falcon_collection___change_count__"),g===e&&f===d?!1:(ko.utils.domData.set(a,"__falcon_object__cid__",d),ko.utils.domData.set(a,"__falcon_collection___change_count__",e),!0)):!0},v=null!=(A=ko.bindingHandlers.foreach)?A:{},ko.bindingHandlers.foreach={init:function(){var a,b,c,d;return b=arguments[0],d=arguments[1],a=3<=arguments.length?D.call(arguments,2):[],c=ko.utils.unwrapObservable(d()),ko.utils.domData.set(b,"__falcon_collection___change_count__",-1),v.init.apply(v,[b,w(c)].concat(D.call(a)))},update:function(){var a,b,c,d;return b=arguments[0],d=arguments[1],a=3<=arguments.length?D.call(arguments,2):[],c=ko.utils.unwrapObservable(d()),C(b,c)?v.update.apply(v,[b,w(c)].concat(D.call(a))):void 0}};for(q in v)u=v[q],q in ko.bindingHandlers.foreach||(ko.bindingHandlers.foreach[q]=u);x=null!=(B=ko.bindingHandlers.options)?B:function(){},ko.bindingHandlers.options=function(){return{init:function(){var a,b,c,d;return b=arguments[0],c=arguments[1],a=3<=arguments.length?D.call(arguments,2):[],u=ko.utils.unwrapObservable(c()),ko.utils.domData.set(b,"__falcon_collection___change_count__",-1),(null!=(d=x.init)?d:function(){}).apply(null,[b,w(u)].concat(D.call(a)))},update:function(){var a,b,c,d;return b=arguments[0],c=arguments[1],a=3<=arguments.length?D.call(arguments,2):[],u=ko.utils.unwrapObservable(c()),C(b,u)?(null!=(d=x.update)?d:function(){}).apply(null,[b,w(u)].concat(D.call(a))):void 0}}}(),ko.bindingHandlers.log={update:function(a,b){return console.log(ko.utils.unwrapObservable(b()))}},ko.virtualElements.allowedBindings.view=!0,ko.virtualElements.allowedBindings.log=!0}).call(this);