(function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M=[].slice,N={}.hasOwnProperty,O=function(a,b){function c(){this.constructor=a}for(var d in b)N.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},P=[].indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(b in this&&this[b]===a)return b;return-1};u=function(a){return null!=a&&"[object Object]"===Object.prototype.toString.call(a)},r=function(a){return null!=a&&"[object Function]"===Object.prototype.toString.call(a)},o=function(a){return null!=a&&"[object Boolean]"===Object.prototype.toString.call(a)},n=function(a){return null!=a&&"[object Array]"===Object.prototype.toString.call(a)},v=function(a){return null!=a&&"[object String]"===Object.prototype.toString.call(a)},t=function(a){return null!=a&&"[object Number]"===Object.prototype.toString.call(a)},s=function(a){return t(a)&&a!==a},q=function(a){var b,c;if(null==a)return!0;if(v(a))return 0===z(a).length;if(n(a))return 0===a.length;if(u(a)){for(b in a)return c=a[b],!1;return!0}return!1},p="object"==typeof HTMLElement?function(a){return a instanceof HTMLElement}:function(a){return null!=a&&1===a.nodeType&&"string"==typeof a.nodeName},z=String.prototype.trim?function(a){return String.prototype.trim.call(a)}:function(a){return a.replace(/^\s+/,"").replace(/\s+$/,"")},A=function(a){return a.replace(/^[\\/\s]+/,"").replace(/[\\/\s]+$/,"")},y=function(a,b){return 0===a.indexOf(b)},k=function(a,b){return a.lastIndexOf(b)===a.length-1},x=function(a){var b,c;c=[];for(b in a)c.push(b);return c},l=function(a,b){var c,d;null==a&&(a={}),u(b)||(b={});for(c in b)d=b[c],a[c]=d;return a},m=function(a,b){var c,d;for(c in a)if(d=a[c],d===b)return c;return void 0},j=function(a){var b,c,d;if(!u(a))return a;if(a instanceof Date)return new Date(a.getTime());if(a instanceof RegExp)return b="",null!=a.global&&(b+="g"),null!=a.ignoreCase&&(b+="i"),null!=a.multiline&&(b+="m"),null!=a.sticky&&(b+="y"),new RegExp(a.source,b);d=new a.constructor;for(c in a)d[c]=j(a[c]);return d},i=function(a){var b,c,d,e,f;for(c={},e=0,f=a.length;f>e;e++)b=a[e],c[b]=!0;return function(){var a;a=[];for(b in c)d=c[b],a.push(b);return a}()},h=function(a,b){var c,d,e,f;if(!n(a))return[];for(n(b)||(b=[b]),d=0,f=b.length;f>d;d++)c=b[d],a=function(){var b,d,f;for(f=[],b=0,d=a.length;d>b;b++)e=a[b],e!==c&&f.push(e);return f}();return a},f=function(){function a(){var a,d,e,f,g,h,i;if(this.__falcon_object__cid__=c++,u(this.defaults)){e=this.defaults;for(a in e)d=e[a],this[a]=r(d)?d.apply(this,arguments):u(d)?j(d):n(d)?d.slice(0):d}if(u(this.observables)){f=this.observables;for(a in f)d=f[a],this[a]=r(d)?ko.computed({read:d,owner:this,deferEvaluation:null!=(g=b.deferEvaluation)?g:!0}):u(d)&&("read"in d||"write"in d)?ko.computed({read:d.read,write:d.write,owner:null!=(h=d.owner)?h:this,deferEvaluation:null!=(i=b.deferEvaluation)?i:!0,disposeWhen:d.disposeWhen,disposeWhenNodeIsRemoved:d.disposeWhenNodeIsRemoved}):n(d)?ko.observableArray(d.slice(0)):ko.observable(d)}}var c;return c=0,a.prototype.observables=null,a.prototype.defaults=null,a.extend=function(a,b){var c,d,e,f,g;f=this,d=a&&a.hasOwnProperty("constructor")?a.constructor:function(){return f.apply(this,arguments)};for(e in f)g=f[e],d[e]=g;for(e in b)g=b[e],d[e]=g;c=function(){this.constructor=d},c.prototype=f.prototype,d.prototype=new c;for(e in a)g=a[e],d.prototype[e]=g;return d.__super__=f.prototype,d},a.prototype.__falcon_object__events__=null,a.prototype.__falcon_object__listeners__=null,a.prototype.__falcon_object__cid__=null,a.prototype.on=function(a,b,c){var d;return v(a)&&r(b)?(null==c&&(c=this),a=z(a).toLowerCase(),q(a)?this:(null==this.__falcon_object__events__&&(this.__falcon_object__events__={}),(null!=(d=this.__falcon_object__events__)[a]?(d=this.__falcon_object__events__)[a]:d[a]=[]).push({callback:b,context:c}),this)):this},a.prototype.off=function(a,b){var c;return v(a)?(a=z(a).toLowerCase(),q(a)||null==this.__falcon_object__events__[a]?this:(null==this.__falcon_object__events__&&(this.__falcon_object__events__={}),r(b)?(this.__falcon_object__events__[a]=function(){var d,e,f,g;for(f=this.__falcon_object__events__[a],g=[],d=0,e=f.length;e>d;d++)c=f[d],c.callback!==b&&g.push(c);return g}.call(this),this.__falcon_object__events__[a].length<=0&&(this.__falcon_object__events__[a]=null)):this.__falcon_object__events__[a]=null,this)):this},a.prototype.has=function(a,b){var c,d,e,f;if(!v(a))return!1;if(a=z(a).toLowerCase(),null==this.__falcon_object__events__&&(this.__falcon_object__events__={}),q(a)||null==this.__falcon_object__events__[a])return!1;if(null!=this.__falcon_object__events__[a]&&!r(b))return!0;for(f=this.__falcon_object__events__[a],d=0,e=f.length;e>d;d++)if(c=f[d],c.callback===b)return!0;return!1},a.prototype.trigger=function(){var a,b,c,d,e,f;if(b=arguments[0],a=2<=arguments.length?M.call(arguments,1):[],!v(b))return this;if(b=z(b).toLowerCase(),null==this.__falcon_object__events__&&(this.__falcon_object__events__={}),q(b)||null==this.__falcon_object__events__[b])return this;for(f=this.__falcon_object__events__[b],d=0,e=f.length;e>d;d++)c=f[d],c.callback.apply(c.context,a);return this},a.prototype.listenTo=function(a,c,d){return b.isFalconObject(a)?v(c)&&r(d)?(a.on(c,d,this),null==this.__falcon_object__listeners__&&(this.__falcon_object__listeners__=[]),this.__falcon_object__listeners__.push({object:a,event:c,callback:d}),this):this:this},a.prototype.stopListening=function(a,c,d){var e,f,g,h,i,j,k,l,m,n,o;for(v(a)&&(l=[a,c,null],c=l[0],d=l[1],a=l[2]),r(a)&&(m=[a,null],d=m[0],a=m[1]),r(c)&&(n=[c,null],d=n[0],c=n[1]),h=v(c)?c:null,k=b.isFalconObject(a)?a:null,g=r(d)?d:null,null==this.__falcon_object__listeners__&&(this.__falcon_object__listeners__=[]),f=[],o=this.__falcon_object__listeners__,i=0,j=o.length;j>i;i++)e=o[i],a=e.object,c=e.event,d=e.callback,null!=h&&c!==h?f.push(e):null!=k&&a!==k?f.push(e):null!=g&&d!==g?f.push(e):a.off(c,d);return this.__falcon_object__listeners__=f,this},a}(),c=function(a){function c(){return G=c.__super__.constructor.apply(this,arguments)}return O(c,a),c.extend=f.extend,c.prototype.resolveRequestType=function(a,b){return v(b)?(b=z(b).toUpperCase(),"GET"!==b&&"PUT"!==b&&"POST"!==b&&"DELETE"!==b?"GET":b):"GET"},c.prototype.resolveContext=function(a,b,c,d){var e;return null!=(e=null!=d?d:c.context)?e:a},c.prototype.standardizeOptions=function(){var a;return a=function(){function a(a){var b,c;if(u(a))for(b in a)c=a[b],this[b]=c;else r(a)?this.complete=a:v(a)?this.attributes=z(a).split(","):n(a)&&(this.attributes=a)}return a.prototype.success=function(){},a.prototype.complete=function(){},a.prototype.error=function(){},a.prototype.attributes=null,a.prototype.fill_options=null,a.prototype.id=void 0,a.prototype.url=null,a.prototype.data=null,a.prototype.parent=void 0,a}(),function(c,d,e,f){return e instanceof a?e:(e=new a(e),b.isModel(e.parent)||null===e.parent||(e.parent=c.parent),e.url=this.makeUrl(c,d,e,f),e.data=this.serializeData(c,d,e,f),e)}}(),c.prototype.makeUrl=function(a,b,c){var d;return null!=(d=c.url)?d:a.makeUrl(b,c.parent)},c.prototype.makeBaseUrl=function(a,c,d){var e,f,g,h,i;for(h=void 0===d.parent?a.parent:d.parent,g=[];b.isModel(h);)f=r(h.url)?h.url("GET",h.parent):h.url,v(f)||(f=""),i=f.lastIndexOf("."),i>-1&&(f=f.slice(0,i)),g.push(A(f)),g.push(h.get("id")),h=h.parent;return e="/"+g.join("/")+"/",v(b.baseApiUrl)&&(e=""+b.baseApiUrl+e),e=e.replace(/([^:])\/\/+/gi,"$1/").replace(/^\/\//gi,"/")},c.prototype.makeUrlPieces=function(a,c,d,e){var f,g,h,i,j,k;return c=this.resolveRequestType(a,c,d,e),f=this.makeBaseUrl(a,c,d,e),j=r(a.url)?a.url(c,d.parent):a.url,j=v(j)?A(j):"",g="",i=j.lastIndexOf("."),i>-1&&(g=j.slice(i),j=j.slice(0,i)),h="",!b.isModel(a)||"GET"!==c&&"PUT"!==c&&"DELETE"!==c||(h="/"+(null!=(k=d.id)?k:a.get("id"))),{base_url:f,url_piece:j,id_piece:h,extension:g}},c.prototype.serializeData=function(a,b,c){return null!=c.data||"POST"!==b&&"PUT"!==b?c.data:a.serialize(c.attributes)},c.prototype.parseRawResponseData=function(a,b,c,d,e){return e},c.prototype.successResponseHandler=function(a,b,c,d,e){var f,g;switch(g=this.parseRawResponseData(a,b,c,d,e),f=a.parse(g,c),a.fill(f,c.fill_options),b){case"GET":a.trigger("fetch",f);break;case"POST":a.trigger("create",f);break;case"PUT":a.trigger("save",f);break;case"DELETE":a.trigger("destroy",f)}return c.success.call(d,a,g,c,e)},c.prototype.errorResponseHandler=function(a,b,c,d,e){var f;return f=this.parseRawResponseData(a,b,c,d,e),c.error.call(d,a,f,c,e)},c.prototype.completeResponseHandler=function(a,b,c,d,e){var f;return f=this.parseRawResponseData(a,b,c,d,e),c.complete.call(d,a,f,c,e)},c.prototype.sync=function(a,c,d,e){var f;if(!b.isDataObject(a))throw new Error("Expected data_object to be a Model or Collection");return f=!1,c=this.resolveRequestType(a,c,d,e),d=this.standardizeOptions(a,c,d,e),e=this.resolveContext(a,c,d,e),!b.isModel(a)||"PUT"!==c&&"POST"!==c||a.validate(d)?(f=!0,{data_object:a,type:c,options:d,context:e,is_valid:f}):{data_object:a,type:c,options:d,context:e,is_valid:f}},c.prototype.getTemplate=function(a,b){var c;if(!v(a))throw new Error("uri must be a String");if(!r(b))throw new Error("callback must be a Function");return c=document.getElementById(a.slice(1)),b(null!=c?c.innerHTML:""),this},c}(f),e=function(a){function c(a,d){var e,f;if(c.__super__.constructor.apply(this,arguments),a=ko.unwrap(a),d=ko.unwrap(d),null!=d&&!b.isModel(d)&&b.isModel(a)&&(e=[a,d],d=e[0],a=e[1]),null==d&&b.isModel(a)&&(f=[a,d],d=f[0],a=f[1]),null!=d&&!b.isModel(d))throw new Error("parent must be null or a Falcon.Model");return this.parent=d,this.initialize.apply(this,arguments),q(a)||this.fill(a),this}return O(c,a),c.extend=f.extend,c.prototype.id=null,c.prototype.url=null,c.prototype.parent=null,c.prototype.initialize=function(){},c.prototype.get=function(a){return v(a)?ko.unwrap(this[a]):thisundefined},c.prototype.set=function(a,b){var c,d;if(u(a)){for(c in a)d=a[c],this.set(c,d);return this}return v(a)?(ko.isObservable(this[a])?this[a](b):this[a]=b,this):this},c.prototype.toggle=function(a){return this.set(a,!this.get(a))},c.prototype.increment=function(a){return this.set(a,this.get(a)+1),this},c.prototype.decrement=function(a){return this.set(a,this.get(a)-1),this},c.prototype.parse=function(a){return a},c.prototype.fill=function(a){var c,d,e,f;if((t(a)||v(a))&&(a={id:a}),!u(a))return this;if(q(a))return this;d={},f=b.Model.prototype;for(c in f)e=f[c],"id"!==c&&"url"!==c&&(d[c]=!0);for(c in a)e=a[c],d[c]||(e=ko.unwrap(e),b.isModel(this[c])?b.isModel(e)?this[c]=e:this[c].fill(e):b.isCollection(this[c])?b.isCollection(e)?this[c]=e:this[c].fill(e):ko.isWriteableObservable(this[c])?this[c](e):this[c]=e);return this},c.prototype.unwrap=function(){var a,c,d;c={};for(a in this)d=this[a],"id"!==a&&a in b.Model.prototype||(c[a]=b.isDataObject(d)?d.unwrap():d);return c},c.prototype.serialize=function(a){var c,d,e,f,g,h,i;if(e={},null==a?a=function(){var a;a=[];for(c in this)"id"!==c&&c in b.Model.prototype||a.push(c);return a}.call(this):v(a)&&(a=z(a).split(",")),n(a)){for(d={},h=0,i=a.length;i>h;h++)c=a[h],d[c]=null;a=d}if(!u(a))return e;for(c in a)f=a[c],g=this[c],b.isDataObject(g)?e[c]=g.serialize(f):ko.isObservable(g)?e[c]=ko.unwrap(g):r(g)||(e[c]=g);return e},c.prototype.makeUrl=function(a,c,d){var e,f,g,h,i,j;return void 0===d&&(v(c)||t(c))&&(i=[d,c],c=i[0],d=i[1]),j=b.adapter.makeUrlPieces(this,a,{parent:c,id:d},this),e=j.base_url,h=j.url_piece,g=j.id_piece,f=j.extension,""+e+h+g+f},c.prototype.validate=function(){return!0},c.prototype.sync=function(a,c,d){return b.adapter.sync(this,a,c,d)},c.prototype.fetch=function(a,b){return this.sync("GET",a,b)},c.prototype.create=function(a,b){return this.sync("POST",a,b)},c.prototype.save=function(a,b){return this.isNew()?this.create(a,b):this.sync("PUT",a,b)},c.prototype.destroy=function(a,b){return this.sync("DELETE",a,b)},c.prototype.equals=function(a){var c,d;return a=ko.unwrap(a),b.isModel(a)?(c=this.get("id"),d=a.get("id"),null!=c&&null!=d?a.get("id")===this.get("id"):a===this):t(a)||v(a)?a===this.get("id"):!1},c.prototype.mixin=function(a){var c,d,e,f=this;u(a)||(a={});for(c in a)d=a[c],b.isDataObject(this[c])?this[c].mixin(d):ko.isObservable(d)?this[c]=ko.observable(null!=(e=this.get(c))?e:ko.unwrap(d)):r(d)?!function(){var a;return a=d,f[c]=function(){var b;return b=1<=arguments.length?M.call(arguments,0):[],a.call.apply(a,[f,f].concat(M.call(b)))}}():null==this[c]&&(this[c]=d);return this},c.prototype.clone=function(a,c){var d;return(null===a||b.isModel(a))&&(d=[void 0,a],a=d[0],c=d[1]),null===c||b.isModel(c)||(c=this.parent),new this.constructor(this.serialize(a),c)},c.prototype.isNew=function(){return null==this.get("id")},c}(f),g=function(a){function c(){var a,e=this;c.__super__.constructor.apply(this,arguments),a=this.makeUrl(),this.__falcon_view__is_loaded__=ko.observable(!1),this.__falcon_view__is_rendered__=!1,this.__falcon_view__loaded_url__=a,this.initialize.apply(this,arguments),b.ready(function(){return q(a)||null!=d[a]?e.__falcon_view__is_loaded__(!0):b.adapter.getTemplate(a,function(c){return b.View.cacheTemplate(a,c),e.__falcon_view__is_loaded__(!0)})})}var d;return O(c,a),d={},c.cacheTemplate=function(a,c){return v(a)||(a=""),v(c)||(c=""),q(a)?b.View:(d[a]=c,b.View)},c.cacheTemplates=function(){var a,c,d,e,f,g;for(d=function(){var a,b,d,e;for(d=document.getElementsByTagName("template"),e=[],a=0,b=d.length;b>a;a++)c=d[a],e.push(c);return e}(),e=0,f=d.length;f>e;e++)c=d[e],a=c.getAttribute("id"),null!=a&&b.View.cacheTemplate("#"+a,c.innerHTML),null!=(g=c.parentNode)&&g.removeChild(c);return b.View},c.resetCache=function(){return d={},b.View},c.extend=f.extend,c.prototype.url=null,c.prototype.__falcon_view__is_loaded__=!1,c.prototype.__falcon_view__is_rendered__=!1,c.prototype.__falcon_view__loaded_url__=null,c.prototype.makeUrl=function(){var a;return a=ko.utils.unwrapObservable(this.url),r(a)&&(a=a()),v(a)||(a=""),a=z(a),q(a)||"#"===a.charAt(0)?a:("/"!==a.charAt(0)&&(a="/"+a),v(b.baseTemplateUrl)&&(a=""+b.baseTemplateUrl+a),a=a.replace(/([^:])\/\/+/gi,"$1/"))},c.prototype.template=function(){var a;return ko.utils.unwrapObservable(this.__falcon_view__is_loaded__)?null!=(a=d[this.__falcon_view__loaded_url__])?a:"":""},c.prototype._render=function(){this.__falcon_view__is_rendered__||(this.__falcon_view__is_rendered__=!0,this.display.apply(this,arguments))},c.prototype._unrender=function(){this.__falcon_view__is_rendered__&&(this.__falcon_view__is_rendered__=!1,this.dispose.apply(this,arguments))},c.prototype.initialize=function(){},c.prototype.display=function(){},c.prototype.dispose=function(){},c.__falcon_view__viewModel__=null,c.prototype.viewModel=function(){var a;return a=function(a,b){var c;return c=function(){return a.apply(b,arguments)},c.__falcon_bind__length__=a.length,c},function(){var c,d,e;if(null!=this.__falcon_view__viewModel__)return this.__falcon_view__viewModel__;e={};for(c in this)d=this[c],c in b.View.prototype||(r(d)&&!ko.isObservable(d)&&(d=a(d,this)),e[c]=d);return this.__falcon_view__viewModel__=e}}(),c}(f),d=function(c){function d(a,c){var e,f,g=this;if(d.__super__.constructor.apply(this,arguments),a=ko.unwrap(a),c=ko.unwrap(c),null==c&&b.isModel(a)&&(e=[a,c],c=e[0],a=e[1]),b.isModel(a)&&n(c)&&(f=[a,c],c=f[0],a=f[1]),null!=c&&!b.isModel(c))throw new Error("parent must be null or a Falcon.Model");return null!=this.model&&null==this.url&&(this.url=this.model.prototype.url),this.length=ko.computed({deferEvaluation:!0,read:function(){return g.models().length}}),this.parent=c,this.__falcon_collection__mixins__=[],this.reset(),this.initialize.apply(this,arguments),q(a)||this.fill(a),this}var e,g,h,i,j,k;return O(d,c),d.extend=f.extend,k=function(a){var c,d,e;return a=ko.unwrap(a),b.isCollection(a)&&(a=a.models()),b.isModel(a)?(d=a,e=d.get("id"),null!=e?function(a){var c,e;return b.isModel(a)?(c=a.get("id"),e=d.get("id"),c===e):!1}:function(a){return b.isModel(a)?a===d:!1}):t(a)||v(a)?(c=a,function(a){return b.isModel(a)?a.get("id")===c:!1}):n(a)?function(b){return P.call(a,b)>=0}:a},d.prototype.__falcon_collection__mixins__=null,d.prototype.__falcon_collection__change_count__=0,d.prototype.models=null,d.prototype.model=null,d.prototype.url=null,d.prototype.length=0,d.prototype.parent=null,d.prototype.comparator=null,d.prototype.initialize=function(){},d.prototype.set=function(a,b){return this.each(function(c){return c.set(a,b)}),this},d.prototype.parse=function(a){return a},d.prototype.unwrap=function(){var a,c,d,e;c=[],e=this.models();for(a in e)d=e[a],c[a]=b.isDataObject(d)?d.unwrap():d;return c},d.prototype.serialize=function(a){var c,d,e,f;d=[],f=this.models();for(c in f)e=f[c],d[c]=b.isDataObject(e)?e.serialize(a):e;return d},d.prototype.makeUrl=function(a,c){var d,e,f,g;return g=b.adapter.makeUrlPieces(this,a,{parent:c},this),d=g.base_url,f=g.url_piece,e=g.extension,""+d+f+e},d.prototype.sync=function(a,c,d){return b.adapter.sync(this,a,c,d)},d.prototype.fetch=function(a,b){return this.sync("GET",a,b)},d.prototype.create=function(a,c,d){var e,f,g=this;return null==this.model?null:(u(a)||b.isModel(a)||(a={}),e=b.isModel(a)?a:new this.model(a,this.parent),null==d&&(d=e),f=b.adapter.standardizeOptions(e,"POST",c,d),null==f.fill_options&&(f.fill_options={method:"append"}),f.success=function(a){return g.fill(a,f.fill_options),r(c.success)?c.success.apply(d,arguments):void 0},e.create(f,d))},d.prototype.destroy=function(a,c,d){var e,f=this;return null==this.model?null:(a=this.first(ko.unwrap(a)),b.isModel(a)?(null==d&&(d=a),e=b.adapter.standardizeOptions(a,"DELETE",c,d),e.success=function(a){return f.remove(a),r(c.success)?c.success.apply(d,arguments):void 0},a.destroy(e,d)):null)},d.prototype.remove=function(a){var c;return a=ko.unwrap(a),b.isCollection(a)&&(a=a.models()),this.__falcon_collection__change_count__++,c=n(a)?this.models.removeAll(a):this.models.remove(k(a)),this},h=function(a,c){return ko.isObservable(c)&&(c=ko.unwrap(c)),null==c&&(c=[]),b.isCollection(c)&&(c=c.all()),n(c)||(c=[c]),c=c.slice(0)},g=function(a,c){var d,e,f,g;for(d=f=0,g=c.length;g>f;d=++f)e=c[d],u(e)&&!b.isModel(e)&&(c[d]=new a.model(e,a.parent));return c},e=function(a,b){var c,d,e,f,g;for(g=[],e=0,f=b.length;f>e;e++)c=b[e],g.push(function(){var b,e,f,g;for(f=a.__falcon_collection__mixins__,g=[],b=0,e=f.length;e>b;b++)d=f[b],g.push(c.mixin(d));return g}());return g},i=function(a,b){var c,d,e,f;u(b)||(b={}),d={};for(c in b)e=b[c],d[c]=e;return null==d.comparator&&(d.comparator=a.comparator),v(d.method)||(d.method="replace"),d.method=z(d.method.toLowerCase()),"replace"!==(f=d.method)&&"append"!==f&&"prepend"!==f&&"insert"!==f&&"merge"!==f&&(d.method="replace"),d},j=function(a,b,c){return r(c.comparator)&&b.sort(c.comparator),a.__falcon_collection__change_count__++,a.models(b)},d.prototype.fill=function(a,b){return b=i(this,b),this[b.method](a,b)},d.prototype.replace=function(a,b){return null==this.model?[]:(b=i(this,b),a=h(this,a),a=g(this,a),e(this,a),j(this,a,b),a)},d.prototype.append=function(a,b){var c;return null==this.model?[]:(b=i(this,b),a=h(this,a),a=g(this,a),c=this.models(),c=c.concat(a),e(this,a,b),j(this,c,b),a)},d.prototype.prepend=function(a,c){var d,f,k,l,m,n,o,p;if(null==this.model)return[];for(c=i(this,c),a=h(this,a),a=g(this,a),d=l=0,n=a.length;n>l;d=++l)f=a[d],u(f)&&!b.isModel(f)&&(a[d]=new this.model(f,this.parent));for(p=a.length-1,k=this.models(),d=m=0,o=a.length;o>m;d=++m)f=a[d],k.unshift(a[p-d]);return e(this,a,c),j(this,k,c),a},d.prototype.insert=function(a,c){var d,f,l,m,n,o;return r(c)&&(c={iterator:c}),(t(c)||v(c)||b.isModel(c))&&(c={model:c}),c=i(this,c),a=h(this,a),a=g(this,a),f=null!=(n=c.index)?n:this.indexOf(k(null!=(o=c.iterator)?o:c.model)),l=this.models(),0>f||f>=l.length?l=l.concat(a):(d=l.slice(0,f),m=l.slice(f),l=d.concat(a,m)),e(this,a,c),j(this,l,c),a},d.prototype.merge=function(a,c){var d,f,g,l,m,n,o,p,q,r,s,t,v;if(null==this.model)return[];for(c=i(this,c),a=h(this,a),d=[],o=this.models(),p=0,s=a.length;s>p;p++)if(g=a[p],f=null,b.isModel(g)){for(l=k(g),q=0,t=o.length;t>q;q++)if(m=o[q],l(m)){f=m;break}b.isModel(f)?f.fill(g.unwrap()):(o.push(g),d.push(g))}else if(u(g)){for(l=k(g.id),r=0,v=o.length;v>r;r++)if(m=o[r],l(m)){f=m;break}b.isModel(f)?f.fill(g):(n=new this.model(g,this.parent),o.push(n),d.push(n))}return e(this,d),j(this,o,c),d},d.prototype.unshift=function(){return this.prepend.apply(this,arguments)},d.prototype.shift=function(){var a;return a=this.models.shift()},d.prototype.push=function(){return this.append.apply(this,arguments)},d.prototype.pop=function(){var a;return this.__falcon_collection__change_count__++,a=this.models.pop()},d.prototype.sort=function(a){return r(a)?this.models.sort(a):models},d.prototype.at=function(a){var b;return a=parseInt(a),s(a)?null:(b=this.models(),0>a||a>=b.length?null:b[a])},d.prototype.indexOf=function(a){var c,d,e,f,g;if(b.isModel(a))return this.models.indexOf(a);if(d=k(a),!r(d))return-1;for(g=this.models(),c=e=0,f=g.length;f>e;c=++e)if(a=g[c],d(a))return c;return-1},d.prototype.lastIndexOf=function(a){var b,c,d,e,f,g,h;if(d=k(a),!r(d))return-1;for(f=this.models(),e=f.length,b=g=0,h=f.length;h>g;b=++g)if(a=f[b],c=e-b-1,d(f[c]))return c;return-1},d.prototype.each=function(a,b){var c,d,e,f,g,h,i,j;if(!r(a))return this;if(null==b&&(b=this),1===a.length)for(i=this.models(),e=0,g=i.length;g>e;e++)d=i[e],a.call(b,d);else for(j=this.models(),c=f=0,h=j.length;h>f;c=++f)d=j[c],a.call(b,c,d);return this},d.prototype.first=function(a){var b,c,d,e;for(a=k(a),r(a)||(a=function(){return!0}),e=this.models(),c=0,d=e.length;d>c;c++)if(b=e[c],a(b))return b;return null},d.prototype.last=function(a){var b,c,d,e,f,g;for(a=k(a),r(a)||(a=function(){return!0}),e=this.models(),d=e.length,b=f=0,g=e.length;g>f;b=++f)if(c=e[b],c=e[d-b-1],a(c))return c;return null},d.prototype.all=function(){return this.models()},d.prototype.filter=function(a){var b;return a=k(a),r(a)?function(){var c,d,e,f;for(e=this.models(),f=[],c=0,d=e.length;d>c;c++)b=e[c],a(b)&&f.push(b);return f}.call(this):this.models()},d.prototype.any=function(a){var b,c,d,e;if(a=k(a),!r(a))return!1;for(e=this.models(),c=0,d=e.length;d>c;c++)if(b=e[c],a(b))return!0;return!1},d.prototype.without=function(a){var b;return a=k(a),r(a)?function(){var c,d,e,f;for(e=this.models(),f=[],c=0,d=e.length;d>c;c++)b=e[c],a(b)||f.push(b);return f}.call(this):this.models()},d.prototype.pluck=function(a,b){var c,d,e,f,g;for(v(a)||(a=""),o(b)||(b=!0),e=[],d=this.models(),f=0,g=d.length;g>f;f++)c=d[f],null!=c?e.push(b?ko.unwrap(c[a]):c[a]):e.push(void 0);return e},d.prototype.slice=function(a,b){return null!=b?this.models.slice(a,b):this.models.slice(a)},d.prototype.chain=function(){var b;return b=new a,b.model=this.model,b.fill(this.models()),b},d.prototype.mixin=function(a){var c,d,e,f,g,h,i,j=this;u(a)||(a={}),i={};for(c in a)f=a[c],ko.isObservable(f)?i[c]=ko.observable(ko.unwrap(f)):r(f)?!function(){var a;return a=f,i[c]=function(){var b;return b=1<=arguments.length?M.call(arguments,0):[],a.apply(b[0],[b[0],j].concat(b.slice(1)))},i[c].length=a.length}():i[c]=f;for(e=this.models(),g=0,h=e.length;h>g;g++)d=e[g],b.isDataObject(d)&&d.mixin(i);return this.__falcon_collection__mixins__.push(i),this},d.prototype.clone=function(a,c){var d;return(null===a||b.isModel(a))&&(d=[void 0,a],a=d[0],c=d[1]),null===c||b.isModel(c)||(c=this.parent),new this.constructor(this.serialize(a),c)},d.prototype.reset=function(){return this.__falcon_collection__change_count__++,null!=this.models?this.models([]):this.models=ko.observableArray([]),this},d}(f),a=function(a){function b(){return H=b.__super__.constructor.apply(this,arguments)}return O(b,a),b.prototype.slice=function(){return this.models(b.__super__.slice.apply(this,arguments)),this},b.prototype.sort=function(){return this.models(b.__super__.sort.apply(this,arguments)),this},b.prototype.filter=function(){return this.models(b.__super__.filter.apply(this,arguments)),this},b.prototype.without=function(){return this.models(b.__super__.without.apply(this,arguments)),this},b}(d),ko.bindingHandlers.view=function(){var a;return a=function(a){var c;return c=a(),(b.isView(c)||ko.isObservable(c))&&(c={data:c}),u(c)||(c={}),null==c.data&&(c.data=null),null==c.displayIf&&(c.displayIf=!0),null==c.afterDisplay&&(c.afterDisplay=null),null==c.beforeDispose&&(c.beforeDispose=null),c},{init:function(c,d,e,f,g){var h,i,j,k,l,m,n,o,p;return n=a(d),p=n.data,k=!1,l=!1,j=function(){},ko.isSubscribable(p)?(m=ko.unwrap(p),o=p.subscribe(function(a){return b.isView(m)&&m._unrender(),m=a}),ko.utils.domNodeDisposal.addDisposeCallback(c,function(){return b.isView(m)&&m._unrender(),o.dispose()})):b.isView(p)&&ko.utils.domNodeDisposal.addDisposeCallback(c,function(){return p._unrender()}),i=document.createElement("div"),h=new ko.templateSources.anonymousTemplate(c),h.nodes(i),h.text(""),ko.computed({disposeWhenNodeIsRemoved:c,read:function(){var e,m,o,s,t,u,v,w;return n=a(d),e=ko.utils.peekObservable(n.afterDisplay),m=ko.utils.peekObservable(n.beforeDispose),p=ko.unwrap(n.data),s=b.isView(p),o=s&&ko.unwrap(p.__falcon_view__is_loaded__),t=o&&ko.unwrap(n.displayIf),u=(t?null!=(v=p.template())?v:"":"").toString(),t=!q(u),j=function(){var a;return j=function(){},l=!1,k=!1,t?(a=g.createChildContext(f).extend({$view:p.viewModel()}),i.innerHTML=u,h.text(u),ko.renderTemplate(c,a,{},c),k=!0,p._render(),r(e)?e(ko.virtualElements.childNodes(c)):void 0):(s&&p.__falcon_view__is_rendered__&&p._unrender(),ko.virtualElements.emptyNode(c))},l?void 0:k&&r(m)?2===(null!=(w=m.__falcon_bind__length__)?w:m.length)?(l=!0,m(ko.virtualElements.childNodes(c),function(){return j()})):(m(ko.virtualElements.childNodes(c)),j()):j()}}),{controlsDescendantBindings:!0}}}}(),D=function(a){return a=ko.utils.peekObservable(a),(b.isCollection(a)||n(a))&&(a={data:a}),u(a)||(a={}),a.data=ko.unwrap(a.data),b.isCollection(a.data)&&(a.data=a.data.models()),null==a.data&&(a.data=[]),function(){return a}},L=function(a,c){var d,e,f,g;return b.isCollection(c)?(f=ko.utils.domData.get(a,"__falcon_object__cid__"),d=c.__falcon_object__cid__,e=c.__falcon_collection__change_count__,g=ko.utils.domData.get(a,"__falcon_collection___change_count__"),g===e&&f===d?!1:(ko.utils.domData.set(a,"__falcon_object__cid__",d),ko.utils.domData.set(a,"__falcon_collection___change_count__",e),!0)):!0},C=null!=(I=ko.bindingHandlers.foreach)?I:{},ko.bindingHandlers.foreach={init:function(){var a,b,c,d;return b=arguments[0],d=arguments[1],a=3<=arguments.length?M.call(arguments,2):[],c=ko.unwrap(d()),ko.utils.domData.set(b,"__falcon_collection___change_count__",-1),C.init.apply(C,[b,D(c)].concat(M.call(a)))},update:function(){var a,b,c,d;return b=arguments[0],d=arguments[1],a=3<=arguments.length?M.call(arguments,2):[],c=ko.unwrap(d()),L(b,c)?C.update.apply(C,[b,D(c)].concat(M.call(a))):void 0}};for(w in C)B=C[w],w in ko.bindingHandlers.foreach||(ko.bindingHandlers.foreach[w]=B);E=function(a){return a=ko.unwrap(a),b.isCollection(a)&&(a=a.models()),function(){return a}},F=null!=(J=ko.bindingHandlers.options)?J:function(){},ko.bindingHandlers.options=function(){return{init:function(){var a,b,c,d;return b=arguments[0],c=arguments[1],a=3<=arguments.length?M.call(arguments,2):[],B=ko.unwrap(c()),ko.utils.domData.set(b,"__falcon_collection___change_count__",-1),(null!=(d=F.init)?d:function(){}).apply(null,[b,E(B)].concat(M.call(a)))},update:function(){var a,b,c,d;return b=arguments[0],c=arguments[1],a=3<=arguments.length?M.call(arguments,2):[],B=ko.unwrap(c()),L(b,B)?(null!=(d=F.update)?d:function(){}).apply(null,[b,E(B)].concat(M.call(a))):void 0}}}(),ko.bindingHandlers.log={update:function(a,b){return console.log(ko.unwrap(b()))}},ko.virtualElements.allowedBindings.view=!0,ko.virtualElements.allowedBindings.log=!0,this.Falcon=b=new(function(a){function h(){return K=h.__super__.constructor.apply(this,arguments)}return O(h,a),h.prototype.Object=f,h.prototype.Model=e,h.prototype.Collection=d,h.prototype.View=g,h.prototype.Adapter=c,h.prototype.version="0.10.2",h.prototype.applicationElement="body",h.prototype.baseApiUrl="",h.prototype.baseTemplateUrl="",h.prototype.deferEvaluation=!0,h.prototype.adapter=new c,h.prototype.ready=function(){var a,c,d,e,f;return f=[],e=function(a){return r(a)?f.push(a):void 0},d=function(){var a,b,c;for(e=function(a){return r(a)?a():void 0},b=0,c=f.length;c>b;b++)a=f[b],a();return f=null},document.addEventListener?document.addEventListener("DOMContentLoaded",a=function(){return d(),document.removeEventListener("DOMContentLoaded",a,!1)},!1):(c=document.onreadystatechange,document.onreadystatechange=function(){return"complete"===document.readyState&&(d(),document.onreadystatechange=c),r(c)?c.apply(this,arguments):void 0}),document.createElement("template"),e(function(){return b.View.cacheTemplates()}),function(){return e.apply(null,arguments)}}(),h.prototype.apply=function(a,c,d){var e,f;return r(c)&&(e=[c,null],d=e[0],c=e[1]),!r(a)||ko.isObservable(a)||r(d)||(f=[a,null],d=f[0],a=f[1]),null==c&&(c=b.applicationElement),b.ready(function(){var b;return p(c)||(v(c)||(c=""),c=q(c)?"body":z(c),c=null!=(b=document.querySelectorAll(c)[0])?b:document.body),null!=a?ko.applyBindingAccessorsToNode(c,{view:function(){return a}}):ko.applyBindings({},c),r(d)?d():void 0}),b},h.prototype.isModel=function(a){return null!=a&&a instanceof b.Model},h.prototype.isCollection=function(a){return null!=a&&a instanceof b.Collection},h.prototype.isView=function(a){return null!=a&&a instanceof b.View},h.prototype.isDataObject=function(a){return null!=a&&(a instanceof b.Model||a instanceof b.Collection)},h.prototype.isAdapter=function(a){return null!=a&&a instanceof b.Adapter},h.prototype.isFalconObject=function(a){return null!=a&&a instanceof b.Object},h.prototype.addBinding=function(a,b,c){var d;return o(b)&&(d=[c,b],b=d[0],c=d[1]),r(b)&&(b={update:b}),ko.bindingHandlers[a]=b,c&&(ko.virtualElements.allowedBindings[a]=!0),ko.bindingHandlers[a]},h.prototype.getBinding=function(a){return ko.bindingHandlers[a]},h}(f))}).call(this);