((function(){var $document,$window,Falcon,arrayContains,arrayPeek,arrayRemove,arrayUnique,arraysEqual,compact,countSubstrings,defer,delay,endsWith,extend,isArray,isBoolean,isEmpty,isFunction,isNumber,isObject,isString,key,objectKeys,objectValues,objectsEqual,startsWith,trim,trimSlashes,value,_bindingContext,_foreach,_getItems,_options,_ref,_shouldUpdate,__slice=Array.prototype.slice,__hasProp=Object.prototype.hasOwnProperty,__extends=function(a,b){function d(){this.constructor=a}for(var c in b)__hasProp.call(b,c)&&(a[c]=b[c]);return d.prototype=b.prototype,a.prototype=new d,a.__super__=b.prototype,a},__indexOf=Array.prototype.indexOf||function(a){for(var b=0,c=this.length;b<c;b++)if(b in this&&this[b]===a)return b;return-1};isObject=function(a){return typeof a==typeof {}&&a!==null},isFunction=function(a){return Object.prototype.toString.call(a)==="[object Function]"},isBoolean=function(a){return Object.prototype.toString.call(a)==="[object Boolean]"},isArray=function(a){return Object.prototype.toString.call(a)==="[object Array]"},isString=function(a){return Object.prototype.toString.call(a)==="[object String]"},isNumber=function(a){return Object.prototype.toString.call(a)==="[object Number]"},isEmpty=function(a){var b,c;if(isObject(a)){for(b in a)return c=a[b],!1;return!0}return isString(a)||isArray(a)?a.length===0:a===null||typeof a=="undefined"?!0:!1},trim=function(a){return a.replace(/^\s+/,"").replace(/\s+$/,"")},trimSlashes=function(a){return a.replace(/^\//,"").replace(/\/$/,"")},startsWith=function(a,b){return a.indexOf(b)===0},endsWith=function(a,b){return a.indexOf(b,a.length-b.length)!==-1},countSubstrings=function(a,b){return a.split(b).length-1},objectKeys=function(a){var b,c;c=[];for(b in a)c.push(b);return c},objectValues=function(a){var b,c,d;d=[];for(b in a)c=a[b],d.push(c);return d},objectsEqual=function(a,b){var c,d;for(c in a){d=a[c];if(b[c]!==d)return!1}for(c in b){d=b[c];if(a[c]!==d)return!1}return!0},compact=function(a){var b,c,d;isObject(a)||(a={}),c={};for(b in a)d=a[b],d!=null&&(c[b]=d);return c},extend=function(a,b){var c,d;a==null&&(a={}),isObject(b)||(b={});for(c in b)d=b[c],a[c]=d;return a},arraysEqual=function(a,b){var c,d,e;if(a.length!==b.length)return!1;for(c=0,e=a.length;c<e;c++){d=a[c];if(b[c]!==d)return!1}return!0},arrayPeek=function(a){return a[a.length-1]},arrayContains=function(a,b){var c,d,e;if(isFunction(a.indexOf))return a.indexOf(b)!==-1;if(isArray(a))for(d=0,e=a.length;d<e;d++){c=a[d];if(c===b)return!0}return!1},arrayUnique=function(a){var b,c,d,e,f;c={};for(e=0,f=a.length;e<f;e++)b=a[e],c[b]=!0;return function(){var a;a=[];for(b in c)d=c[b],a.push(b);return a}()},arrayRemove=function(a,b){var c,d,e,f;if(!isArray(a))return[];isArray(b)||(b=[b]);for(d=0,f=b.length;d<f;d++)c=b[d],a=function(){var b,d,f;f=[];for(b=0,d=a.length;b<d;b++)e=a[b],e!==c&&f.push(e);return f}();return a},delay=function(a,b){var c;return isFunction(a)&&(c=[b,a],a=c[0],b=c[1]),isNumber(a)||(a=1),isFunction(b)||(b=function(){}),a<1&&(a=1),setTimeout(b,a)},defer=function(a){return isFunction(a)||(a=function(){}),setTimeout(a,1)},Falcon={version:"0.0.2",baseApiUrl:"",apply:function(a){return $(function(){return $("body").attr("data-bind","view: $data"),ko.applyBindings(a)})},isModel:function(a){return a!=null&&a instanceof Falcon.Model},isCollection:function(a){return a!=null&&a instanceof Falcon.Collection},isView:function(a){return a!=null&&a instanceof Falcon.View},isDataObject:function(a){return a!=null&&(a instanceof Falcon.Model||a instanceof Falcon.Collection)},isFalconObject:function(a){return a!=null&&a instanceof Falcon.Class}},this.Falcon=Falcon,$window=$(window),$document=$(document),Falcon.Class=function(){function a(){this._events={}}return a.prototype["super"]=function(){},a.extend=function(a,b){var c,d;return a==null&&(a=Falcon.Class),c=null,b!=null&&b.hasOwnProperty("constructor")?c=b.constructor:c=function(){return this.__super__.apply(this,arguments)},d=function(){},d.prototype=a.prototype,c.prototype=new d,c.prototype.__super__=function(){return a.apply(this,arguments)},c.extend=function(a){return Falcon.Class.extend(c,a)},extend(c.prototype,b!=null?b:{}),c},a.prototype._events=null,a.prototype.on=function(a,b,c){var d,e;return!isString(a)||!isFunction(b)?this:(c==null&&(c=this),a=trim(a).toLowerCase(),isEmpty(a)?this:(((e=(d=this._events)[a])!=null?e:d[a]=[]).push({action:b,context:c}),this))},a.prototype.off=function(a,b){var c;return!isString(a)||!isFunction(b)?this:(a=trim(a).toLowerCase(),isEmpty(a)||this._events[a]==null?this:(this._events[a]=function(){var d,e,f,g;f=this._events[a],g=[];for(d=0,e=f.length;d<e;d++)c=f[d],c.action!==b&&g.push(c);return g}.call(this),this))},a.prototype.has=function(a,b){var c,d,e,f;if(!isString(a)||!isFunction(b))return!1;a=trim(a).toLowerCase();if(isEmpty(a)||this._events[a]==null)return!1;f=this._events[a];for(d=0,e=f.length;d<e;d++){c=f[d];if(c.action===b)return!0}return!1},a.prototype.relay=function(a,b){var c,d=this;return isString(b)||(c=[b,a],a=c[0],b=c[1]),Falcon.isFalconObject(a)?isEmpty(b)?this:(a.on(b,function(){return d.trigger.apply(d,[b].concat(__slice.call(arguments)))}),this):this},a.prototype.trigger=function(){var a,b,c,d,e,f;b=arguments[0],a=2<=arguments.length?__slice.call(arguments,1):[];if(!isString(b))return this;b=trim(b).toLowerCase();if(isEmpty(b)||this._events[b]==null)return this;f=this._events[b];for(d=0,e=f.length;d<e;d++)c=f[d],c.action.apply(c.context,a);return this},a}(),Falcon.Model=function(a){function b(a,c){var d,e,f,g;b.__super__.constructor.call(this),a=ko.utils.unwrapObservable(a),c=ko.utils.unwrapObservable(c),c==null&&Falcon.isModel(a)&&(f=[a,c],c=f[0],a=f[1]),Falcon.isModel(a)&&(a=a.unwrap()),this.id=ko.observable(ko.utils.unwrapObservable(this.id)),this.loading=ko.observable(ko.utils.unwrapObservable(this.loading)),this.fields===null&&(this.fields={}),this.parent=c,this.initialize(a),this.fill(a),g=this.fields;for(d in g)e=g[d],!this[e]&&isString(e)&&(this[e]=ko.observable())}return __extends(b,a),b.extend=function(a){return Falcon.Class.extend(Falcon.Model,a)},b.prototype.id=null,b.prototype.url=null,b.prototype.parent=null,b.prototype.fields=null,b.prototype.loading=!1,b.prototype.initialize=function(a){},b.prototype.fill=function(a){var b,c,d,e,f,g,h;if(!isObject(a))return this;Falcon.isModel(a)&&(a=a.unwrap()),c={};if(isObject(this.fields)&&!isEmpty(this.fields))for(d in a)g=a[d],c[(h=this.fields[d])!=null?h:d]=g;else c=a;e=objectKeys(Falcon.Model.prototype),b=arrayRemove(objectKeys(this),e),f=arrayRemove(e,b),f=arrayRemove(f,"id"),f=arrayUnique(f);for(d in c){g=c[d];if(__indexOf.call(f,d)>=0)continue;g=ko.utils.unwrapObservable(g),this[d]==null?(!ko.isObservable(g)&&!Falcon.isDataObject(g)&&(isArray(g)?g=ko.observableArray(g):g=ko.observable(g)),this[d]=g):Falcon.isDataObject(this[d])?this[d].fill(g):ko.isObservable(this[d])?ko.isWriteableObservable(this[d])&&this[d](g):this[d]=g}return this},b.prototype.unwrap=function(){var a,b,c,d,e,f;c={},b=arrayRemove(objectKeys(this),objectKeys(Falcon.Model.prototype)),b[b.length]="id",b=arrayUnique(b);for(e=0,f=b.length;e<f;e++)a=b[e],d=this[a],c[a]=Falcon.isDataObject(d)?d.unwrap():d;return c},b.prototype.serialize=function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n;f={},i=[],e=[];if(isArray(this.fields)&&!isEmpty(this.fields)){m=this.fields;for(k=0,l=m.length;k<l;k++)a=m[k],i[i.length]=a,e[e.length]=a}else if(isObject(this.fields)&&!isEmpty(this.fields)){n=this.fields;for(g in n)c=n[g],i[i.length]=g,e[e.length]=c in this?c:g}else i=e=arrayRemove(objectKeys(this),objectKeys(Falcon.Model.prototype));i.push("id"),i=arrayUnique(i),e.push("id"),e=arrayUnique(e);for(b in e)d=e[b],h=i[b],j=this[d],Falcon.isDataObject(j)?f[h]=j.serialize():ko.isObservable(j)?f[h]=ko.utils.unwrapObservable(j):isFunction(j)||(f[h]=j);return f},b.prototype.makeUrl=function(a,b){var c,d,e,f,g;g=isFunction(this.url)?this.url():this.url,isString(g)||(g=""),g=trim(g),isString(a)||(a=""),a=a.toUpperCase(),a!=="GET"&&a!=="PUT"&&a!=="POST"&&a!=="DELETE"&&(a="GET"),b=Falcon.isModel(b)?b:this.parent,c="",f=g.lastIndexOf("."),f>-1&&(c=g.slice(f),g=g.slice(0,f)),startsWith(g,"/")||(g="/"+g),Falcon.isModel(b)?(e=b.makeUrl(),d=e.lastIndexOf("."),d>-1&&(e=e.slice(0,d)),e=trim(e),g=""+e+g):isString(Falcon.baseApiUrl)&&(g=""+Falcon.baseApiUrl+g);if(a==="GET"||a==="PUT"||a==="DELETE")g.slice(-1)!=="/"&&(g+="/"),g+=this.id();return""+g+c},b.prototype.sync=function(a,b){var c,d,e,f,g,h,i=this;isFunction(b)&&(b={complete:b}),isObject(b)||(b={}),isObject(b.data)||(b.data={}),isString(b.dataType)||(b.dataType="json"),isString(b.contentType)||(b.contentType="application/json"),isFunction(b.success)||(b.success=function(){}),isFunction(b.complete)||(b.complete=function(){}),isFunction(b.error)||(b.error=function(){}),Falcon.isModel(b.parent)||(b.parent=this.parent),a=trim(isString(a)?a.toUpperCase():"GET"),a!=="GET"&&a!=="POST"&&a!=="PUT"&&a!=="DELETE"&&(a="GET"),c={};if(!isEmpty(b.data)){h=b.data;for(e in h)g=h[e],c[e]=g}if(a==="POST"||a==="PUT")c=extend(c,this.serialize());return d=isEmpty(c)?"":JSON.stringify(c),f=this.makeUrl(a,b.parent),this.loading(!0),$.ajax({url:f,type:a,data:d,dataType:b.dataType,contentType:b.contentType,success:function(c){var d;i.fill(c);switch(a){case"GET":i.trigger("fetch",c);break;case"POST":i.trigger("create",c);break;case"PUT":i.trigger("save",c);break;case"DELETE":i.trigger("destroy",c)}return(d=b.success).call.apply(d,[i,i].concat(__slice.call(arguments)))},error:function(a){var c;c=a.responseText;try{isString(c)&&(c=JSON.parse(c))}catch(d){}return b.error.call(i,i,c,a)},complete:function(){var a;return i.loading(!1),(a=b.complete).call.apply(a,[i,i].concat(__slice.call(arguments)))}}),this},b.prototype.fetch=function(a){return this.sync("GET",a)},b.prototype.create=function(a){return this.sync("POST",a)},b.prototype.save=function(a){return this.sync("PUT",a)},b.prototype.destroy=function(a){return this.sync("DELETE",a)},b.prototype.map=function(a){var b,c,d=this;isObject(a)||(a={});for(b in a)c=a[b],Falcon.isDataObject(this[b])?this[b].map(c):ko.isObservable(c)?this[b]=ko.observable(ko.utils.unwrapObservable(c)):isFunction(c)?function(){var a;return a=c,d[b]=function(){var b;return b=1<=arguments.length?__slice.call(arguments,0):[],a.call.apply(a,[d,d].concat(__slice.call(b)))}}():this[b]=c;return this},b.prototype.clone=function(a){return a=a===null||Falcon.isModel(a)?a:this.parent,new this.constructor(this.unwrap(),a)},b}(Falcon.Class),Falcon.View=function(a){function c(){var a=this;c.__super__.constructor.call(this),this.template=ko.observable(ko.utils.unwrapObservable(this.template)),isString(this.url)||(this.url=""),this.url=trim(this.url),this._loaded=ko.observable(ko.utils.unwrapObservable(this._loaded)),this._loaded.subscribe(function(b){if(!!b)return a.trigger("load")}),this.isLoaded=ko.computed(function(){return!!a._loaded()}),isEmpty(this.url)?this._loaded(!0):this.url in b?(this.template(b[this.url]),this._loaded(!0)):startsWith(this.url,"#")?(b[this.url]=$(this.url).html(),this.template(b[this.url]),this._loaded(!0)):$.ajax({url:this.url,type:"GET",cache:!1,success:function(c){return b[a.url]=c,a.template(c),a._loaded(!0)}}),this.initialize.apply(this,arguments)}var b;return __extends(c,a),b={},c.extend=function(a){return Falcon.Class.extend(Falcon.View,a)},c.prototype._loaded=!1,c.prototype._loadQueue=[],c.prototype.url=null,c.prototype.template=null,c.prototype.initialize=function(){},c.prototype.isLoaded=function(){return this._loaded},c.prototype.viewModel=function(){var a,b,c,d=this;c={__falcon__:!0};for(a in this){b=this[a];if(a in Falcon.View.prototype)continue;isFunction(b)&&!ko.isObservable(b)&&(b=function(){var a;return a=b,function(){var b;return b=1<=arguments.length?__slice.call(arguments,0):[],a.call.apply(a,[d].concat(__slice.call(b)))}}()),c[a]=b}return c},c.prototype.load=function(a){this.on("load",a);if(this.isLoaded())return this.trigger("load")},c.prototype.dispose=function(){},c.prototype.call=function(a){var b,c,d=this;if(!isString(a))throw new Error("Method must be a string");c=this[a];if(!isFunction(c))throw new Error("'"+a+"' is not a valid method.");return b=Array.prototype.slice.call(arguments,1),function(){return c.apply(d,b)}},c}(Falcon.Class),Falcon.Collection=function(a){function b(a,c){var d,e=this;b.__super__.constructor.call(this),a=ko.utils.unwrapObservable(a),c=ko.utils.unwrapObservable(c),c==null&&Falcon.isModel(a)&&(d=[a,c],c=d[0],a=d[1]),this.model!=null&&this.url==null&&(this.url=this.model.prototype.url),this.parent=c,this.length=ko.observable(ko.utils.unwrapObservable(this.length)),this.loading=ko.observable(ko.utils.unwrapObservable(this.loading)),this.populated=ko.computed(function(){return e.length()>0}),this._mappings=[],this.reset().fill(a),this.initialize(a)}return __extends(b,a),b.prototype._mappings=null,b.extend=function(a){return Falcon.Class.extend(Falcon.Collection,a)},b.prototype.list=null,b.prototype.model=null,b.prototype.__change_count__=0,b.prototype.url=null,b.prototype.length=0,b.prototype.parent=null,b.prototype.loading=!1,b.prototype.initialize=function(){},b.prototype.fill=function(a,b){var c,d,e,f,g,h,i,j,k,l;if(this.model==null)return this;a==null&&(a=[]),Falcon.isCollection(a)&&(a=a.list()),ko.isObservable(a)&&(a=ko.utils.unwrapObservable(a)),isArray(a)||(a=[a]),i=[],b==null&&(b={}),isObject(b)||(b={}),h=b.method,isString(h)||(h=""),h=h.toLowerCase(),h!=="replace"&&h!=="append"&&h!=="prepend"&&(h="replace"),this.__change_count__++;for(c in a){f=a[c],i[c]=new this.model({},this.parent),l=this._mappings;for(j=0,k=l.length;j<k;j++)g=l[j],i[c].map(g);i[c].fill(Falcon.isModel(f)?f.serialize():f)}if(h==="replace")this.list(i);else if(h==="prepend"){e=function(){var a,b,c,e;c=this.list(),e=[];for(a=0,b=c.length;a<b;a++)d=c[a],e.push(d);return e}.call(this);while(i.length>0)e.unshift(i.pop());this.list(e)}else if(h==="append"){e=this.list(),e=function(){var a,b,c;c=[];for(a=0,b=e.length;a<b;a++)d=e[a],c.push(d);return c}();while(i.length>0)e.push(i.shift());this.list(e)}return this.length(this.list().length),this},b.prototype.unwrap=function(){var a,b,c,d;b=[],d=this.list();for(a in d)c=d[a],b[a]=Falcon.isDataObject(c)?c.unwrap():c;return b},b.prototype.serialize=function(){var a,b,c,d;b=[],d=this.list();for(a in d)c=d[a],b[a]=Falcon.isDataObject(c)?c.serialize():c;return b},b.prototype.makeUrl=function(a){var b,c,d;return d=isFunction(this.url)?this.url():this.url,isString(d)||(d=""),d=trim(d),isString(a)||(a=""),a=a.toUpperCase(),a!=="GET"&&a!=="PUT"&&a!=="POST"&&a!=="DELETE"&&(a="GET"),startsWith(d,"/")||(d="/"+d),Falcon.isModel(this.parent)?(c=this.parent.makeUrl(),b=c.lastIndexOf("."),b>-1&&(c=c.slice(0,b)),c=trim(c),d=""+c+d):isString(Falcon.baseApiUrl)&&(d=""+Falcon.baseApiUrl+d),d},b.prototype.fetch=function(a){return this.sync("GET",a)},b.prototype.sync=function(a,b){var c,d,e,f,g,h,i,j,k=this;isFunction(b)&&(b={success:b}),isObject(b)||(b={}),isObject(b.data)||(b.data={}),isString(b.dataType)||(b.dataType="json"),isString(b.contentType)||(b.contentType="application/json"),isFunction(b.success)||(b.success=function(){}),isFunction(b.complete)||(b.complete=function(){}),isFunction(b.error)||(b.error=function(){}),a=isString(a)?a.toUpperCase():"GET",a!=="GET"&&a!=="POST"&&a!=="PUT"&&a!=="DELETE"&&(a="GET"),a=trim(a),c={};if(!isEmpty(b.data)){i=b.data;for(d in i)f=i[d],c[d]=f}e=trim(this.makeUrl(a));if(e==null||!isString(e))return;return this.loading(!0),g=b.complete,h=b.error,j=b.success,$.ajax({url:e,type:a,data:c,dataType:b.dataType,contentType:b.contentType,success:function(c,d,e){return c==null&&(c=[]),isString(c)&&(c=JSON.parse(c)),isEmpty(c)&&(c=JSON.parse(e.responseText)),a==="GET"&&k.fill(c,b),j.call.apply(j,[k,k].concat(__slice.call(arguments)))},error:function(a){var b;b=a.responseText;try{isString(b)&&(b=JSON.parse(b))}catch(c){}return h.call(k,k,b,a)},complete:function(){return k.loading(!1),g.call.apply(g,[k,k].concat(__slice.call(arguments)))}}),this},b.prototype.remove=function(a){var b;return a=ko.utils.unwrapObservable(a),Falcon.isCollection(a)&&(a=a.list()),this.__change_count__++,b=isArray(a)?this.list.removeAll(a):this.list.remove(a),isEmpty(b)||this.length(this.list().length),this},b.prototype.append=function(a){return this.fill(a,{method:"append"})},b.prototype.prepend=function(a){return this.fill(a,{method:"prepend"})},b.prototype.pop=function(){var a;return a=this.list.pop(),this.length(this.list().length),a},b.prototype.create=function(a,b){var c,d=this;if(this.model==null)return;return Falcon.isModel(a)&&(a=a.unwrap()),isObject(a)||(a={}),isFunction(b)&&(b={success:b}),isObject(b)||(b={}),isFunction(b.success)||(b.success=function(){}),isString(b.method)||(b.method="append"),c=b.success,b.success=function(a){return d.fill(a,b),c.apply(a,arguments)},(new this.model(a,this.parent)).create(b)},b.prototype.destroy=function(a,b){var c,d,e,f,g=this;if(this.model==null)return this;a=ko.utils.unwrapObservable(a);if(a==null||a==="all")a=this.list();Falcon.isCollection(a)&&(a=a.list()),isArray(a)||(a=[a]);if(isEmpty(a))return this;isFunction(b)&&(b={success:b}),isObject(b)||(b={}),isFunction(b.success)||(b.success=function(){}),b.parent=this.parent,f=b.success,b.success=function(a){return g.remove(a),f.apply(a,arguments)};for(d=0,e=a.length;d<e;d++)c=a[d],Falcon.isDataObject(c)&&c.destroy(b);return this},b.prototype.at=function(a){var b;return isNumber(a)||(a=0),b=this.list(),a<0&&(a=0),a>=b.length&&(a=b.length-1),b[a]},b.prototype.first=function(a){var b,c,d,e;isFunction(a)||(a=function(){return!0}),e=this.list();for(c=0,d=e.length;c<d;c++){b=e[c];if(a(b))return b}return null},b.prototype.last=function(a){var b,c,d;isFunction(a)||(a=function(){return!0}),d=this.list();for(b in d){c=d[b],c=d[d.length-b-1];if(a(c))return c}return null},b.prototype.all=function(a){var b;return isFunction(a)||(a=function(){return!0}),function(){var c,d,e,f;e=this.list(),f=[];for(c=0,d=e.length;c<d;c++)b=e[c],a(b)&&f.push(b);return f}.call(this)},b.prototype.any=function(a){var b,c,d,e,f;Falcon.isModel(a)&&(e=a,a=function(a){return Falcon.isModel(a)?a.id()===e.id():!1});if(!isFunction(a))return!1;f=this.list();for(c=0,d=f.length;c<d;c++){b=f[c];if(a(b))return!0}return!1},b.prototype.map=function(a){var b,c,d,e,f,g,h,i=this;isObject(a)||(a={}),g={};for(b in a)d=a[b],ko.isObservable(d)?g[b]=ko.observable(ko.utils.unwrapObservable(d)):isFunction(d)?function(){var a;return a=d,g[b]=function(){return a.call(arguments[0],arguments[0],i)}}():g[b]=d;h=this.list();for(e=0,f=h.length;e<f;e++)c=h[e],Falcon.isDataObject(c)&&c.map(g);return this._mappings.push(g),this},b.prototype.clone=function(a){return a=a===null||Falcon.isModel(a)?a:this.parent,new this.constructor(this.unwrap(),a)},b.prototype.reset=function(){return this.list==null&&(this.list=ko.observableArray([])),this.list([]),this.length(0),this.__change_count__+=1,this},b}(Falcon.Class),Falcon.Event=function(){function a(a){if(a==null)throw new Error("Element must be given");this._element=$(a)}return a.UP_KEY=38,a.DOWN_KEY=40,a.RIGHT_KEY=39,a.LEFT_KEY=37,a.ENTER_KEY=13,a.prototype._element=null,a.prototype.on=function(a,b){var c,d;isString(a)||(a=""),c=this._element,isFunction(b)||(b=function(){}),a=trim(a);if(isEmpty(a))return;return d=function(){var e;return e=1<=arguments.length?__slice.call(arguments,0):[],c.parents("body").length>0?b.call.apply(b,[this].concat(__slice.call(e))):$window.off(a,d)},$window.on(a,d)},a}(),_shouldUpdate=function(a,b){var c,d;return Falcon.isCollection(b)?(c=b.__change_count__,d=ko.utils.domData.get(a,"__falcon_collection___change_count__"),d===c?!1:(ko.utils.domData.set(a,"__falcon_collection___change_count__",c),!0)):!0},_getItems=function(a){var b;return b=ko.utils.unwrapObservable(Falcon.isCollection(a)?a.list():a),isArray(b)||(b=[b]),function(){return b}},ko.bindingHandlers.view=function(){var getTemplate,getViewModel,makeTemplateValueAccessor;return makeTemplateValueAccessor=function(a){return function(){return{"if":a,data:a,templateEngine:ko.nativeTemplateEngine.instance}}},getViewModel=function(a){var b,c;return b={},a==null&&(a={}),a instanceof Falcon.View?b=a.viewModel():b=ko.utils.unwrapObservable((c=a.viewModel)!=null?c:{}),b},getTemplate=function(a){var b,c;return b="",a==null&&(a={}),a instanceof Falcon.View?b=a.template():b=ko.utils.unwrapObservable((c=a.template)!=null?c:""),b},{init:function(a,b,c,d,e){var f;return f=b(),f=ko.utils.unwrapObservable(f),d=getViewModel(f),ko.bindingHandlers.template.init(a,makeTemplateValueAccessor(d),c,d,e),{controlsDescendantBindings:!0}},update:function(element,valueAccessor,allBindingsAccessor,viewModel,context){var anonymousTemplate,execScripts,template,value;value=valueAccessor(),value=ko.utils.unwrapObservable(value),context.$view=value,viewModel=getViewModel(value),template=getTemplate(value);if(!isObject(value))return;if(ko.utils.domData.get(element,"__falcon_view_updating__")===!0)return;return ko.utils.domData.set(element,"__falcon_view_updating__",!0),execScripts=!!ko.utils.unwrapObservable(value.execScripts),template==null?$(element).html(""):isEmpty(viewModel)?$(element).html(""):(anonymousTemplate=ko.utils.domData.get(element,"__ko_anon_template__"),anonymousTemplate.containerData.innerHTML=template,ko.bindingHandlers.template.update(element,makeTemplateValueAccessor(viewModel),allBindingsAccessor,viewModel,context),template!==anonymousTemplate&&execScripts===!0&&$(element).find("script").each(function(index,script){script=$(script);if(script.attr("type").toLowerCase()==="text/javascript")return eval(script.text())})),ko.utils.domData.set(element,"__falcon_view_updating__",!1),{controlsDescendantBindings:!0}}}}(),_foreach=ko.bindingHandlers.foreach,ko.bindingHandlers.foreach={init:function(){var a,b,c,d,e;return b=arguments[0],d=arguments[1],a=3<=arguments.length?__slice.call(arguments,2):[],c=ko.utils.unwrapObservable(d()),ko.utils.domData.set(b,"__falcon_collection___change_count__",-1),((e=_foreach["init"])!=null?e:function(){}).apply(null,[b,_getItems(c)].concat(__slice.call(a)))},update:function(){var a,b,c,d,e;b=arguments[0],d=arguments[1],a=3<=arguments.length?__slice.call(arguments,2):[],c=ko.utils.unwrapObservable(d());if(_shouldUpdate(b,c))return((e=_foreach["update"])!=null?e:function(){}).apply(null,[b,_getItems(c)].concat(__slice.call(a)))}};for(key in _foreach)value=_foreach[key],key in ko.bindingHandlers.foreach||(ko.bindingHandlers.foreach[key]=value);ko.bindingHandlers.collection=ko.bindingHandlers.foreach,_options=(_ref=ko.bindingHandlers["options"])!=null?_ref:function(){},ko.bindingHandlers.options=function(){return{init:function(){var a,b,c,d;return b=arguments[0],c=arguments[1],a=3<=arguments.length?__slice.call(arguments,2):[],value=ko.utils.unwrapObservable(c()),ko.utils.domData.set(b,"__falcon_collection___change_count__",-1),((d=_options["init"])!=null?d:function(){}).apply(null,[b,_getItems(value)].concat(__slice.call(a)))},update:function(){var a,b,c,d;b=arguments[0],c=arguments[1],a=3<=arguments.length?__slice.call(arguments,2):[],value=ko.utils.unwrapObservable(c());if(_shouldUpdate(b,value))return((d=_options["update"])!=null?d:function(){}).apply(null,[b,_getItems(value)].concat(__slice.call(a)))}}}(),_bindingContext=ko.bindingContext,ko.bindingContext=function(a,b){return this["$view"]==null&&b!=null&&(this.$view=b.$view||b.$root),_bindingContext.call(this,a,b)},ko.bindingContext.prototype=_bindingContext.prototype,ko.virtualElements.allowedBindings.view=!0,ko.virtualElements.allowedBindings.collection=!0,ko.subscribable.fn.classify=function(){var a,b,c,d,e;c=1<=arguments.length?__slice.call(arguments,0):[],a={};for(d=0,e=c.length;d<e;d++){b=c[d];if(!isString(b)||!!isEmpty(trim(b)))continue;b=trim(b),a[b]=!0}return this.extend(a),this}})).call(this)