(function(){var e={}.hasOwnProperty,t=function(t,n){function o(){this.constructor=t}for(var l in n)e.call(n,l)&&(t[l]=n[l]);return o.prototype=n.prototype,t.prototype=new o,t.__super__=n.prototype,t};describe("Test View Methods",function(){var e,n,o,l,r,a,i,s,c,u,p,d,h,f;return e=function(e){function n(){return s=n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.url="view_a",n}(Falcon.View),n=function(e){function n(){return c=n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.url=function(){return"view_b"},n}(Falcon.View),o=function(e){function n(){return u=n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.url="#view_c",n}(Falcon.View),l=function(e){function n(){return p=n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.url=function(){return"#view_d"},n}(Falcon.View),r=function(e){function n(){return d=n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.url="/view_e",n}(Falcon.View),a=function(e){function n(){return h=n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.url=function(){return"/view_f"},n}(Falcon.View),i=function(e){function n(){return f=n.__super__.constructor.apply(this,arguments)}return t(n,e),n}(Falcon.View),beforeEach(function(){return Falcon.baseTemplateUrl="",Falcon.cache=!1,Falcon.View.resetCache()}),describe("Test the constructor method",function(){var t,r,a;return r=t=a=null,afterEach(function(){return r&&r.restore(),t&&t.restore(),a?a.restore():void 0}),it("Should call the initialize and ajax methods with the correct arguments",function(){var n;return r=sinon.stub(e.prototype,"initialize"),t=sinon.stub($,"ajax"),a=sinon.stub(window,"$"),n=new e("Hello",123),expect(n.is_loaded()).to.be["false"],expect(n._is_rendered).to.be["false"],expect(r).to.have.been.calledOnce,expect(r).to.have.been.calledWith("Hello",123),expect(r).to.have.been.calledOn(n),expect(t).to.have.been.calledOnce,expect(t).to.have.been.calledAfter(r),expect(t.firstCall.args[0]).not.to.be.undefined,a.should.not.have.been.called}),it("Should call the initialize and jquery methods with the correct arguments",function(){var e;return r=sinon.stub(o.prototype,"initialize"),t=sinon.stub($,"ajax"),a=sinon.stub(window,"$").returns(window.jQuery("<div>")),e=new o("Hello",123),expect(e.is_loaded()).to.be["true"],expect(e._is_rendered).to.be["false"],expect(r).to.have.been.calledOnce,expect(r).to.have.been.calledWith("Hello",123),expect(r).to.have.been.calledOn(e),expect(a).to.have.been.calledOnce,expect(a).to.have.been.calledAfter(r),t.should.not.have.been.called}),it("Should call the ajax method only once",function(){var o;return t=sinon.stub($,"ajax"),a=sinon.stub(window,"$"),o=new e,expect(o.is_loaded()).to.be["false"],expect(t).to.have.been.calledOnce,expect(t.firstCall.args[0]).not.to.be.undefined,t.firstCall.args[0].success("Hello World"),expect(o.is_loaded()).to.be["true"],expect(a).to.not.have.been.called,t.reset(),o=new e,expect(o.is_loaded()).to.be["true"],expect(t).to.not.have.been.called,expect(a).to.not.have.been.called,t.reset(),o=new n,expect(o.is_loaded()).to.be["false"],expect(t).to.have.been.calledOnce,expect(t.firstCall.args[0]).not.to.be.undefined,t.firstCall.args[0].success("Hello World"),expect(o.is_loaded()).to.be["true"],expect(a).to.not.have.been.called}),it("Should call the jquery method only once",function(){var e;return t=sinon.stub($,"ajax"),a=sinon.stub(window,"$").returns(window.jQuery("<div>")),e=new o,expect(e.is_loaded()).to.be["true"],expect(a).to.have.been.calledOnce,expect(t).to.not.have.been.called,a.reset(),e=new o,expect(e.is_loaded()).to.be["true"],expect(a).to.not.have.been.called,expect(t).to.not.have.been.called,a.reset(),e=new l,expect(e.is_loaded()).to.be["true"],expect(a).to.have.been.calledOnce,expect(t).to.not.have.been.called})}),describe("Testing the 'defaults' implementation",function(){return it("Should create RawrView with defaults that have correct arguments",function(){var e,n,o,l;return n=null,e=function(e){function o(){return l=o.__super__.constructor.apply(this,arguments)}return t(o,e),o.prototype.defaults={hello:n=sinon.spy()},o}(Falcon.View),expect(n).to.not.have.been.called,o=new e("one","two","three"),expect(n).to.have.been.called,expect(n.callCount).to.equal(1),expect(n.firstCall.args.length).to.equal(3),expect(n.firstCall.args[0]).to.equal("one"),expect(n.firstCall.args[1]).to.equal("two"),expect(n.firstCall.args[2]).to.equal("three")}),it("Should create RawrVIew with defaults that are numbers",function(){var e,n,o,l;return n=null,e=function(e){function o(){return l=o.__super__.constructor.apply(this,arguments)}return t(o,e),o.prototype.defaults={hello:n=sinon.spy()},o}(Falcon.View),expect(n).to.not.have.been.called,o=new e(1234),expect(n).to.have.been.called,expect(n.callCount).to.equal(1),expect(n.firstCall.args.length).to.equal(1),expect(n.firstCall.args[0]).to.equal(1234)})}),describe("Test the makeUrl() method",function(){var t;return t=null,beforeEach(function(){return t=sinon.stub($,"ajax")}),afterEach(function(){return t.restore()}),it("Should generate the correct relative url from string",function(){return expect((new e).makeUrl()).to.equal("/view_a")}),it("Should generate the correct relative url from function",function(){return expect((new n).makeUrl()).to.equal("/view_b")}),it("Should generate the correct element id from string",function(){return expect((new o).makeUrl()).to.equal("#view_c")}),it("Should generate the correct element id from function",function(){return expect((new l).makeUrl()).to.equal("#view_d")}),it("Should generate the correct relative url from string beginning with '/'",function(){return expect((new r).makeUrl()).to.equal("/view_e")}),it("Should generate the correct relative url from function beginning with '/'",function(){return expect((new a).makeUrl()).to.equal("/view_f")}),it("Should generate the correct relative url from string with baseTemplateUrl",function(){return Falcon.baseTemplateUrl="http://www.falconjs.com",expect((new e).makeUrl()).to.equal("http://www.falconjs.com/view_a")}),it("Should generate the correct relative url from function with baseTemplateUrl",function(){return Falcon.baseTemplateUrl="http://www.falconjs.com",expect((new n).makeUrl()).to.equal("http://www.falconjs.com/view_b")}),it("Should generate the correct element id from string with baseTemplateUrl",function(){return Falcon.baseTemplateUrl="http://www.falconjs.com",expect((new o).makeUrl()).to.equal("#view_c")}),it("Should generate the correct element id from function with baseTemplateUrl",function(){return Falcon.baseTemplateUrl="http://www.falconjs.com",expect((new l).makeUrl()).to.equal("#view_d")}),it("Should generate the correct relative url from string beginning with '/' with baseTemplateUrl",function(){return Falcon.baseTemplateUrl="http://www.falconjs.com",expect((new r).makeUrl()).to.equal("http://www.falconjs.com/view_e")}),it("Should generate the correct relative url from function beginning with '/' with baseTemplateUrl",function(){return Falcon.baseTemplateUrl="http://www.falconjs.com",expect((new a).makeUrl()).to.equal("http://www.falconjs.com/view_f")}),it("Should generate the correct relative url from string with baseTemplateUrl ending in '/'",function(){return Falcon.baseTemplateUrl="http://www.falconjs.com/",expect((new e).makeUrl()).to.equal("http://www.falconjs.com/view_a")}),it("Should generate the correct relative url from function with baseTemplateUrl ending in '/'",function(){return Falcon.baseTemplateUrl="http://www.falconjs.com/",expect((new n).makeUrl()).to.equal("http://www.falconjs.com/view_b")}),it("Should generate the correct element id from string with baseTemplateUrl ending in '/'",function(){return Falcon.baseTemplateUrl="http://www.falconjs.com/",expect((new o).makeUrl()).to.equal("#view_c")}),it("Should generate the correct element id from function with baseTemplateUrl ending in '/'",function(){return Falcon.baseTemplateUrl="http://www.falconjs.com/",expect((new l).makeUrl()).to.equal("#view_d")}),it("Should generate the correct relative url from string beginning with '/' with baseTemplateUrl ending in '/'",function(){return Falcon.baseTemplateUrl="http://www.falconjs.com/",expect((new r).makeUrl()).to.equal("http://www.falconjs.com/view_e")}),it("Should generate the correct relative url from function beginning with '/' with baseTemplateUrl ending in '/'",function(){return Falcon.baseTemplateUrl="http://www.falconjs.com/",expect((new a).makeUrl()).to.equal("http://www.falconjs.com/view_f")})}),describe("Test the viewModel() method",function(){var e,n,o;return e=function(e){function n(){return o=n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.url="full_view",n.prototype.observables={hello:"world",foo:function(){return"bar"},small:function(){return this.hello()+" "+this.foo()}},n.prototype.test=function(){return"things"},n.prototype.another=function(e,t){return this.test()+" "+e+" "+t},n}(Falcon.View),n=null,beforeEach(function(){return n=sinon.stub($,"ajax")}),afterEach(function(){return n.restore()}),it("Should create a valid view model",function(){var t,n,o,l;return o=new e,n=sinon.stub(o,"test"),t=sinon.stub(o,"another"),expect(ko.isObservable(o.hello)).to.be["true"],expect(o.hello()).to.be.equal("world"),expect(ko.isComputed(o.foo)).to.be["true"],expect(o.foo()).to.be.equal("bar"),expect(ko.isComputed(o.small)).to.be["true"],expect(o.small()).to.be.equal("world bar"),expect(o.test).to.be.a("function"),expect(o.another).to.be.a("function"),l=o.viewModel(),expect(ko.isObservable(l.hello)).to.be["true"],expect(l.hello()).to.be.equal("world"),expect(ko.isComputed(l.foo)).to.be["true"],expect(l.foo()).to.be.equal("bar"),expect(ko.isComputed(l.small)).to.be["true"],expect(l.small()).to.be.equal("world bar"),expect(l.test).to.be.a("function"),expect(l.test).to.not.equal(o.test),expect(l.another).to.be.a("function"),expect(l.another).to.not.equal(o.another),expect(n).to.not.have.been.called,expect(t).to.not.have.been.called,l.test(),l.another("hello","world"),expect(n).to.have.been.calledOnce,expect(n).to.have.been.calledOn(o),expect(t).to.have.been.calledOnce,expect(t).to.have.been.calledWith("hello","world"),expect(t).to.have.been.calledOn(o),n.restore(),t.restore()}),it("Should create equal viewModels after the first has been generated",function(){var t,n,o;return o=new e,t=o.viewModel(),n=o.viewModel(),expect(t).to.equal(n)})})})}).call(this);