(function(){var e={}.hasOwnProperty,t=function(t,n){function r(){this.constructor=t}for(var o in n)e.call(n,o)&&(t[o]=n[o]);return r.prototype=n.prototype,t.prototype=new r,t.__super__=n.prototype,t};describe("Test Knockout Bindings",function(){return describe("Test view binding",function(){var e,n,r,o,i,l,a,s,u,c,p,d,h,f,m,v,b,g;return u=ko.bindingHandlers.view,n=$("body"),e=$("<div id='application'></div>"),s=function(e){function n(){return v=n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.url="#layout-template",n.prototype.observables={content_view:null,footer_view:null},n.prototype.initialize=function(){return this.content_view(new l),this.footer_view(new a)},n}(Falcon.View),i=$("			<template id='layout-template'>				<div data-bind='view: $view.content_view'>				</div>				<div data-bind='view: $view.footer_view'>				</div>			</template>		"),l=function(e){function n(){return b=n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.url="#content-template",n}(Falcon.View),r=$("			<template id='content-template'>				The Content			</template>		"),a=function(e){function n(){return g=n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.url="#footer-template",n}(Falcon.View),o=$("			<template id='footer-template'>				The Footer			</template>		"),d=m=f=h=null,c=p=null,before(function(){return n.append(e),n.append(i),n.append(o),n.append(r),c=sinon.spy(u,"init"),p=sinon.spy(u,"update")}),after(function(){return e.remove(),i.remove(),o.remove(),r.remove(),c.restore(),p.restore()}),it("Should call the view binding on initialization without an observable",function(){var e,t,n;return n=new l,e=sinon.spy(n,"render"),t=sinon.spy(n,"unrender"),expect(c).to.not.have.been.called,expect(p).to.not.have.been.called,expect(e).to.not.have.been.called,expect(t).to.not.have.been.called,Falcon.apply(n,"#application"),expect(c).to.have.been.calledOnce,expect(p).to.have.been.calledOnce,expect(e).to.have.been.calledOnce,expect(t).to.not.have.been.called}),describe("Testing changes in views that are contained in observales",function(){var e,t,n,r,o,i,a,u,d,h,f,m,v,b,g,_;return _=new s,o=_.content_view(),m=_.footer_view(),v=ko.observable(null),b=sinon.spy(_,"render"),g=sinon.spy(_,"unrender"),i=sinon.spy(_,"display"),a=sinon.spy(_,"dispose"),n=sinon.spy(o,"render"),r=sinon.spy(o,"unrender"),e=sinon.spy(o,"display"),t=sinon.spy(o,"dispose"),h=sinon.spy(m,"render"),f=sinon.spy(m,"unrender"),u=sinon.spy(m,"display"),d=sinon.spy(m,"dispose"),beforeEach(function(){return c.reset(),p.reset(),b.reset(),n.reset(),h.reset(),i.reset(),e.reset(),u.reset(),g.reset(),r.reset(),f.reset(),a.reset(),t.reset(),d.reset()}),it("Should not call any render or unrender methods on unassigned observable",function(){return Falcon.apply(v,"#application"),expect(c).to.have.been.calledOnce,expect(p).to.have.been.calledOnce,expect(b).to.not.have.been.called,expect(n).to.not.have.been.called,expect(h).to.not.have.been.called,expect(i).to.not.have.been.called,expect(e).to.not.have.been.called,expect(u).to.not.have.been.called,expect(g).to.not.have.been.called,expect(n).to.not.have.been.called,expect(f).to.not.have.been.called,expect(a).to.not.have.been.called,expect(t).to.not.have.been.called,expect(d).to.not.have.been.called}),it("Should call init, update, and render the correct number od times",function(){return v(_),expect(c).to.have.been.calledTwice,expect(p).to.have.been.calledThrice,expect(b).to.have.been.calledOnce,expect(n).to.have.been.calledOnce,expect(h).to.have.been.calledOnce,expect(i).to.have.been.calledOnce,expect(e).to.have.been.calledOnce,expect(u).to.have.been.calledOnce,expect(g).to.not.have.been.called,expect(r).to.not.have.been.called,expect(f).to.not.have.been.called,expect(a).to.not.have.been.called,expect(t).to.not.have.been.called,expect(d).to.not.have.been.called}),it("Should react to a child view being updated",function(){return _.content_view(new l),expect(c).to.not.have.been.called,expect(p).to.have.been.calledOnce,expect(b).to.not.have.been.called,expect(n).to.not.have.been.called,expect(h).to.not.have.been.called,expect(i).to.not.have.been.called,expect(e).to.not.have.been.called,expect(u).to.not.have.been.called,expect(g).to.not.have.been.called,expect(r).to.have.been.calledOnce,expect(f).to.not.have.been.called,expect(a).to.not.have.been.called,expect(t).to.have.been.calledOnce,expect(d).to.not.have.been.called}),it("Should react to the entire, root, view being updated",function(){return v(new l),expect(c).to.not.have.been.called,expect(p).to.have.been.calledOnce,expect(b).to.not.have.been.called,expect(n).to.not.have.been.called,expect(h).to.not.have.been.called,expect(i).to.not.have.been.called,expect(e).to.not.have.been.called,expect(u).to.not.have.been.called,expect(g).to.have.been.calledOnce,expect(r).to.have.been.calledOnce,expect(f).to.have.been.calledTwice,expect(a).to.have.been.calledOnce,expect(t).to.have.not.been.called,expect(d).to.have.been.calledOnce})})}),describe("Test updated foreach binding",function(){var e,n,r,o,i,l,a,s,u;return n=$("body"),e=$("<div id='application'></div>"),i=ko.bindingHandlers.foreach,l=a=null,o=function(e){function n(){return s=n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.defaults={hello:"world"},n.prototype.observables={foo:"bar"},n}(Falcon.Model),r=function(e){function n(){return u=n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.model=o,n}(Falcon.Collection),describe("Test flat bindings against arrays and collections",function(){var s,u,c,p,d,h,f,m,v,b,g;return h=function(e){function n(){return g=n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.url="#layout-template",n.prototype.defaults={collection_list:function(){return new r},collection_list_options:function(){return new r}},n.prototype.observables={array_list:[],array_list_options:[]},n.prototype.afterAdd=function(){},n.prototype.beforeRemove=function(e){return e.remove()},n}(Falcon.View),d=$("				<template id='layout-template'>					<ul class='array_list' data-bind='foreach: $view.array_list'><li>An Item</li></ul>					<ul class='collection_list' data-bind='foreach: $view.collection_list'><li>An Item</li></ul>					<ul class='array_list_options' data-bind='foreach: {data: $view.array_list_options, afterAdd: $view.afterAdd, beforeRemove: $view.beforeRemove}'><li>An Item</li></ul>					<ul class='collection_list_options' data-bind='foreach: {data: $view.collection_list_options, afterAdd: $view.afterAdd, beforeRemove: $view.beforeRemove}'><li>An Item</li></ul>				</template>			"),v=null,b=ko.observable(),s=c=null,u=p=null,f=m=null,before(function(){return n.append(e),n.append(d),l=sinon.spy(i,"init"),a=sinon.spy(i,"update"),Falcon.apply(b,"#application")}),beforeEach(function(){var e;return v=new h,b(v),f=sinon.spy(v.viewModel(),"afterAdd"),m=sinon.spy(v.viewModel(),"beforeRemove"),e=s,s=$(".array_list"),c=$(".collection_list"),u=$(".array_list_options"),p=$(".collection_list_options")}),afterEach(function(){return e.empty(),l.reset(),a.reset(),f.restore(),m.restore()}),after(function(){return e.remove(),d.remove(),l.restore(),a.restore()}),it("Should properly list with an observable array",function(){return expect(l).to.have.been.called,expect(a).to.have.been.called,expect(f).to.not.have.been.called,expect(m).to.not.have.been.called,expect(l.callCount).to.equal(4),expect(a.callCount).to.equal(4),expect(s.children().length).to.equal(0),expect(c.children().length).to.equal(0),expect(u.children().length).to.equal(0),expect(p.children().length).to.equal(0),l.reset(),a.reset(),v.array_list.push("Hello"),v.array_list.push("World","Foo Bar"),expect(l).to.not.have.been.called,expect(a).to.have.been.called,expect(f).to.not.have.been.called,expect(m).to.not.have.been.called,expect(a.callCount).to.equal(2),expect(s.children().length).to.equal(3),expect(c.children().length).to.equal(0),expect(u.children().length).to.equal(0),expect(p.children().length).to.equal(0),a.reset(),v.array_list.pop(),expect(l).to.not.have.been.called,expect(a).to.have.been.called,expect(f).to.not.have.been.called,expect(m).to.not.have.been.called,expect(a.callCount).to.equal(1),expect(s.children().length).to.equal(2),expect(c.children().length).to.equal(0),expect(u.children().length).to.equal(0),expect(p.children().length).to.equal(0)}),it("Should properly list with a collection",function(){return expect(l).to.have.been.called,expect(a).to.have.been.called,expect(f).to.not.have.been.called,expect(m).to.not.have.been.called,expect(l.callCount).to.equal(4),expect(a.callCount).to.equal(4),expect(s.children().length).to.equal(0),expect(c.children().length).to.equal(0),expect(u.children().length).to.equal(0),expect(p.children().length).to.equal(0),l.reset(),a.reset(),v.collection_list.push(new o),v.collection_list.push([new o,new o]),expect(l).to.not.have.been.called,expect(a).to.have.been.called,expect(f).to.not.have.been.called,expect(m).to.not.have.been.called,expect(a.callCount).to.equal(2),expect(s.children().length).to.equal(0),expect(c.children().length).to.equal(3),expect(u.children().length).to.equal(0),expect(p.children().length).to.equal(0),a.reset(),v.collection_list.pop(),expect(l).to.not.have.been.called,expect(a).to.have.been.called,expect(f).to.not.have.been.called,expect(m).to.not.have.been.called,expect(a.callCount).to.equal(1),expect(s.children().length).to.equal(0),expect(c.children().length).to.equal(2),expect(u.children().length).to.equal(0),expect(p.children().length).to.equal(0)}),it("Should properly list with an observable array including options",function(){return expect(l).to.have.been.called,expect(a).to.have.been.called,expect(f).to.not.have.been.called,expect(m).to.not.have.been.called,expect(l.callCount).to.equal(4),expect(a.callCount).to.equal(4),expect(s.children().length).to.equal(0),expect(c.children().length).to.equal(0),expect(u.children().length).to.equal(0),expect(p.children().length).to.equal(0),l.reset(),a.reset(),v.array_list_options.push("Hello2"),v.array_list_options.push("World2","Foo Bar2"),expect(l).to.not.have.been.called,expect(a).to.have.been.called,expect(f).to.have.been.called,expect(m).to.not.have.been.called,expect(a.callCount).to.equal(2),expect(f.callCount).to.equal(3),expect(s.children().length).to.equal(0),expect(c.children().length).to.equal(0),expect(u.children().length).to.equal(3),expect(p.children().length).to.equal(0),a.reset(),f.reset(),v.array_list_options.pop(),v.array_list_options.pop(),expect(l).to.not.have.been.called,expect(a).to.have.been.called,expect(f).to.not.have.been.called,expect(m).to.have.been.called,expect(a.callCount).to.equal(2),expect(m.callCount).to.equal(2),expect(s.children().length).to.equal(0),expect(c.children().length).to.equal(0),expect(u.children().length).to.equal(1),expect(p.children().length).to.equal(0)}),it("Should properly list with a collection including options",function(){return expect(l).to.have.been.called,expect(a).to.have.been.called,expect(f).to.not.have.been.called,expect(m).to.not.have.been.called,expect(l.callCount).to.equal(4),expect(a.callCount).to.equal(4),expect(s.children().length).to.equal(0),expect(c.children().length).to.equal(0),expect(u.children().length).to.equal(0),expect(p.children().length).to.equal(0),l.reset(),a.reset(),v.collection_list_options.push(new o),v.collection_list_options.push([new o,new o]),expect(l).to.not.have.been.called,expect(a).to.have.been.called,expect(f).to.have.been.called,expect(m).to.not.have.been.called,expect(a.callCount).to.equal(2),expect(f.callCount).to.equal(3),expect(s.children().length).to.equal(0),expect(c.children().length).to.equal(0),expect(u.children().length).to.equal(0),expect(p.children().length).to.equal(3),a.reset(),f.reset(),v.collection_list_options.pop(),v.collection_list_options.pop(),expect(l).to.not.have.been.called,expect(a).to.have.been.called,expect(f).to.not.have.been.called,expect(m).to.have.been.called,expect(a.callCount).to.equal(2),expect(m.callCount).to.equal(2),expect(s.children().length).to.equal(0),expect(c.children().length).to.equal(0),expect(u.children().length).to.equal(0),expect(p.children().length).to.equal(1)})}),describe("Test observable bindings against collections",function(){var s,u,c,p,d,h,f,m;return c=function(e){function n(){return m=n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.url="#layout-template",n.prototype.defaults={collection_a1:function(){return new r},collection_a2:function(){return new r}},n.prototype.observables={selected_number:1,selected_collection:function(){return 1===this.selected_number()?this.collection_a1:this.collection_a2}},n}(Falcon.View),u=$("				<template id='layout-template'>					<ul class='collection_list' data-bind='foreach: $view.selected_collection'><li>An Item</li></ul>				</template>			"),h=null,f=ko.observable(),s=null,p=d=null,before(function(){return n.append(e),n.append(u),l=sinon.spy(i,"init"),a=sinon.spy(i,"update"),Falcon.apply(f,"#application")}),beforeEach(function(){return h=new c,f(h),s=$(".collection_list")}),afterEach(function(){return e.empty(),l.reset(),a.reset()}),after(function(){return e.remove(),u.remove(),l.restore(),a.restore()}),it("Should properly update if collection is switched to another with same update count",function(){return expect(l).to.have.been.called,expect(a).to.have.been.called,expect(l.callCount).to.equal(1),expect(a.callCount).to.equal(1),l.reset(),a.reset(),h.collection_a1.fill([new o,new o]),h.collection_a2.fill([new o,new o,new o,new o,new o]),expect(l).to.have.not.been.called,expect(a).to.have.been.called,expect(a.callCount).to.equal(1),expect(s.children().length).to.equal(2),l.reset(),a.reset(),h.selected_number(2),expect(l).to.have.not.been.called,expect(a).to.have.been.called,expect(a.callCount).to.equal(1),expect(s.children().length).to.equal(5),l.reset(),a.reset(),h.selected_number(1),expect(l).to.have.not.been.called,expect(a).to.have.been.called,expect(a.callCount).to.equal(1),expect(s.children().length).to.equal(2)})})}),describe("Test updated options binding",function(){}),describe("Test log binding",function(){})})}).call(this);