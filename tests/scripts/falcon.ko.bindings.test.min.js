(function(){var e={}.hasOwnProperty,t=function(t,o){function n(){this.constructor=t}for(var l in o)e.call(o,l)&&(t[l]=o[l]);return n.prototype=o.prototype,t.prototype=new n,t.__super__=o.prototype,t};describe("Test Knockout Bindings",function(){var e,o,n,l;return e=null,n=0,o=$("body"),l=function(t){return n++,null!=e&&e.remove(),o.append(e=$("<div id='application_"+n+"'></div>")),Falcon.apply(t,"#application_"+n)},describe("Test view binding",function(){var e,n,r,a,c,i,u,s,p,d,h,f;return u=ko.bindingHandlers.view,i=function(e){function o(){return d=o.__super__.constructor.apply(this,arguments)}return t(o,e),o.prototype.url="#layout-template",o.prototype.observables={content_view:null,footer_view:null},o.prototype.initialize=function(){return this.content_view(new a),this.footer_view(new c)},o}(Falcon.View),r=$("			<template id='layout-template'>				<div data-bind='view: $view.content_view'>				</div>				<div data-bind='view: $view.footer_view'>				</div>			</template>		"),a=function(e){function o(){return h=o.__super__.constructor.apply(this,arguments)}return t(o,e),o.prototype.url="#content-template",o}(Falcon.View),e=$("			<template id='content-template'>				The Content			</template>		"),c=function(e){function o(){return f=o.__super__.constructor.apply(this,arguments)}return t(o,e),o.prototype.url="#footer-template",o}(Falcon.View),n=$("			<template id='footer-template'>				The Footer			</template>		"),s=p=null,before(function(){return o.append(r),o.append(n),o.append(e),s=sinon.spy(u,"init"),p=sinon.spy(u,"update")}),after(function(){return r.remove(),n.remove(),e.remove(),s.restore(),p.restore()}),it("Should call the view binding on initialization without an observable",function(){var e,t,o;return o=new a,e=sinon.spy(o,"_render"),t=sinon.spy(o,"_unrender"),expect(s).to.not.have.been.called,expect(p).to.not.have.been.called,expect(e).to.not.have.been.called,expect(t).to.not.have.been.called,l(o),expect(s).to.have.been.calledOnce,expect(p).to.have.been.calledOnce,expect(e).to.have.been.calledOnce,expect(t).to.not.have.been.called}),describe("Testing changes in views that are contained in observales",function(){var e,t,o,n,r,c,u,d,h,f,b,m,_,w,x,v;return v=new i,r=v.content_view(),m=v.footer_view(),_=ko.observable(null),w=sinon.spy(v,"_render"),x=sinon.spy(v,"_unrender"),c=sinon.spy(v,"display"),u=sinon.spy(v,"dispose"),o=sinon.spy(r,"_render"),n=sinon.spy(r,"_unrender"),e=sinon.spy(r,"display"),t=sinon.spy(r,"dispose"),f=sinon.spy(m,"_render"),b=sinon.spy(m,"_unrender"),d=sinon.spy(m,"display"),h=sinon.spy(m,"dispose"),beforeEach(function(){return s.reset(),p.reset(),w.reset(),o.reset(),f.reset(),c.reset(),e.reset(),d.reset(),x.reset(),n.reset(),b.reset(),u.reset(),t.reset(),h.reset()}),it("Should not call any render or unrender methods on unassigned observable",function(){return l(_),expect(s).to.have.been.calledOnce,expect(p).to.have.been.calledOnce,expect(w).to.not.have.been.called,expect(o).to.not.have.been.called,expect(f).to.not.have.been.called,expect(c).to.not.have.been.called,expect(e).to.not.have.been.called,expect(d).to.not.have.been.called,expect(x).to.not.have.been.called,expect(o).to.not.have.been.called,expect(b).to.not.have.been.called,expect(u).to.not.have.been.called,expect(t).to.not.have.been.called,expect(h).to.not.have.been.called}),it("Should call init, update, and render the correct number of times",function(){return _(v),expect(s).to.have.been.calledTwice,expect(p).to.have.been.calledThrice,expect(w).to.have.been.calledOnce,expect(o).to.have.been.calledOnce,expect(f).to.have.been.calledOnce,expect(c).to.have.been.calledOnce,expect(e).to.have.been.calledOnce,expect(d).to.have.been.calledOnce,expect(x).to.not.have.been.called,expect(n).to.not.have.been.called,expect(b).to.not.have.been.called,expect(u).to.not.have.been.called,expect(t).to.not.have.been.called,expect(h).to.not.have.been.called}),it("Should react to a child view being updated",function(){return v.content_view(new a),expect(s).to.not.have.been.called,expect(p).to.have.been.calledOnce,expect(w).to.not.have.been.called,expect(o).to.not.have.been.called,expect(f).to.not.have.been.called,expect(c).to.not.have.been.called,expect(e).to.not.have.been.called,expect(d).to.not.have.been.called,expect(x).to.not.have.been.called,expect(n).to.have.been.calledOnce,expect(b).to.not.have.been.called,expect(u).to.not.have.been.called,expect(t).to.have.been.calledOnce,expect(h).to.not.have.been.called}),it("Should react to the entire, root, view being updated",function(){return _(new a),expect(s).to.not.have.been.called,expect(p).to.have.been.calledOnce,expect(w).to.not.have.been.called,expect(o).to.not.have.been.called,expect(f).to.not.have.been.called,expect(c).to.not.have.been.called,expect(e).to.not.have.been.called,expect(d).to.not.have.been.called,expect(x).to.have.been.called,expect(n).to.not.have.been.called,expect(b).to.have.been.calledOnce,expect(u).to.have.been.calledOnce,expect(t).to.have.not.been.called,expect(h).to.have.been.calledOnce})})}),describe("Test updated foreach binding",function(){var n,r,a,c,i,u,s;return a=ko.bindingHandlers.foreach,c=i=null,r=function(e){function o(){return u=o.__super__.constructor.apply(this,arguments)}return t(o,e),o.prototype.defaults={hello:"world"},o.prototype.observables={foo:"bar"},o}(Falcon.Model),n=function(e){function o(){return s=o.__super__.constructor.apply(this,arguments)}return t(o,e),o.prototype.model=r,o}(Falcon.Collection),describe("Test flat bindings against arrays and collections",function(){var u,s,p,d,h,f,b,m,_,w,x;return f=function(e){function o(){return x=o.__super__.constructor.apply(this,arguments)}return t(o,e),o.prototype.url="#layout-template",o.prototype.defaults={collection_list:function(){return new n},collection_list_options:function(){return new n}},o.prototype.observables={array_list:[],array_list_options:[]},o.prototype.afterAdd=function(){},o.prototype.beforeRemove=function(e){return e.remove()},o}(Falcon.View),h=$("				<template id='layout-template'>					<ul class='array_list' data-bind='foreach: $view.array_list'><li>An Item</li></ul>					<ul class='collection_list' data-bind='foreach: $view.collection_list'><li>An Item</li></ul>					<ul class='array_list_options' data-bind='foreach: {data: $view.array_list_options, afterAdd: $view.afterAdd, beforeRemove: $view.beforeRemove}'><li>An Item</li></ul>					<ul class='collection_list_options' data-bind='foreach: {data: $view.collection_list_options, afterAdd: $view.afterAdd, beforeRemove: $view.beforeRemove}'><li>An Item</li></ul>				</template>			"),_=null,w=ko.observable(),u=p=null,s=d=null,b=m=null,before(function(){return o.append(e),o.append(h),c=sinon.spy(a,"init"),i=sinon.spy(a,"update"),l(w)}),beforeEach(function(){var e;return _=new f,w(_),b=sinon.spy(_.viewModel(),"afterAdd"),m=sinon.spy(_.viewModel(),"beforeRemove"),e=u,u=$(".array_list"),p=$(".collection_list"),s=$(".array_list_options"),d=$(".collection_list_options")}),afterEach(function(){return e.empty(),c.reset(),i.reset(),b.restore(),m.restore()}),after(function(){return e.remove(),h.remove(),c.restore(),i.restore()}),it("Should properly list with an observable array",function(){return expect(c).to.have.been.called,expect(i).to.have.been.called,expect(b).to.not.have.been.called,expect(m).to.not.have.been.called,expect(c.callCount).to.equal(4),expect(i.callCount).to.equal(4),expect(u.children().length).to.equal(0),expect(p.children().length).to.equal(0),expect(s.children().length).to.equal(0),expect(d.children().length).to.equal(0),c.reset(),i.reset(),_.array_list.push("Hello"),_.array_list.push("World","Foo Bar"),expect(c).to.not.have.been.called,expect(i).to.have.been.called,expect(b).to.not.have.been.called,expect(m).to.not.have.been.called,expect(i.callCount).to.equal(2),expect(u.children().length).to.equal(3),expect(p.children().length).to.equal(0),expect(s.children().length).to.equal(0),expect(d.children().length).to.equal(0),i.reset(),_.array_list.pop(),expect(c).to.not.have.been.called,expect(i).to.have.been.called,expect(b).to.not.have.been.called,expect(m).to.not.have.been.called,expect(i.callCount).to.equal(1),expect(u.children().length).to.equal(2),expect(p.children().length).to.equal(0),expect(s.children().length).to.equal(0),expect(d.children().length).to.equal(0)}),it("Should properly list with a collection",function(){return expect(c).to.have.been.called,expect(i).to.have.been.called,expect(b).to.not.have.been.called,expect(m).to.not.have.been.called,expect(c.callCount).to.equal(4),expect(i.callCount).to.equal(4),expect(u.children().length).to.equal(0),expect(p.children().length).to.equal(0),expect(s.children().length).to.equal(0),expect(d.children().length).to.equal(0),c.reset(),i.reset(),_.collection_list.push(new r),_.collection_list.push([new r,new r]),expect(c).to.not.have.been.called,expect(i).to.have.been.called,expect(b).to.not.have.been.called,expect(m).to.not.have.been.called,expect(i.callCount).to.equal(2),expect(u.children().length).to.equal(0),expect(p.children().length).to.equal(3),expect(s.children().length).to.equal(0),expect(d.children().length).to.equal(0),i.reset(),_.collection_list.pop(),expect(c).to.not.have.been.called,expect(i).to.have.been.called,expect(b).to.not.have.been.called,expect(m).to.not.have.been.called,expect(i.callCount).to.equal(1),expect(u.children().length).to.equal(0),expect(p.children().length).to.equal(2),expect(s.children().length).to.equal(0),expect(d.children().length).to.equal(0)}),it("Should properly list with an observable array including options",function(){return expect(c).to.have.been.called,expect(i).to.have.been.called,expect(b).to.not.have.been.called,expect(m).to.not.have.been.called,expect(c.callCount).to.equal(4),expect(i.callCount).to.equal(4),expect(u.children().length).to.equal(0),expect(p.children().length).to.equal(0),expect(s.children().length).to.equal(0),expect(d.children().length).to.equal(0),c.reset(),i.reset(),_.array_list_options.push("Hello2"),_.array_list_options.push("World2","Foo Bar2"),expect(c).to.not.have.been.called,expect(i).to.have.been.called,expect(b).to.have.been.called,expect(m).to.not.have.been.called,expect(i.callCount).to.equal(2),expect(b.callCount).to.equal(3),expect(u.children().length).to.equal(0),expect(p.children().length).to.equal(0),expect(s.children().length).to.equal(3),expect(d.children().length).to.equal(0),i.reset(),b.reset(),_.array_list_options.pop(),_.array_list_options.pop(),expect(c).to.not.have.been.called,expect(i).to.have.been.called,expect(b).to.not.have.been.called,expect(m).to.have.been.called,expect(i.callCount).to.equal(2),expect(m.callCount).to.equal(2),expect(u.children().length).to.equal(0),expect(p.children().length).to.equal(0),expect(s.children().length).to.equal(1),expect(d.children().length).to.equal(0)}),it("Should properly list with a collection including options",function(){return expect(c).to.have.been.called,expect(i).to.have.been.called,expect(b).to.not.have.been.called,expect(m).to.not.have.been.called,expect(c.callCount).to.equal(4),expect(i.callCount).to.equal(4),expect(u.children().length).to.equal(0),expect(p.children().length).to.equal(0),expect(s.children().length).to.equal(0),expect(d.children().length).to.equal(0),c.reset(),i.reset(),_.collection_list_options.push(new r),_.collection_list_options.push([new r,new r]),expect(c).to.not.have.been.called,expect(i).to.have.been.called,expect(b).to.have.been.called,expect(m).to.not.have.been.called,expect(i.callCount).to.equal(2),expect(b.callCount).to.equal(3),expect(u.children().length).to.equal(0),expect(p.children().length).to.equal(0),expect(s.children().length).to.equal(0),expect(d.children().length).to.equal(3),i.reset(),b.reset(),_.collection_list_options.pop(),_.collection_list_options.pop(),expect(c).to.not.have.been.called,expect(i).to.have.been.called,expect(b).to.not.have.been.called,expect(m).to.have.been.called,expect(i.callCount).to.equal(2),expect(m.callCount).to.equal(2),expect(u.children().length).to.equal(0),expect(p.children().length).to.equal(0),expect(s.children().length).to.equal(0),expect(d.children().length).to.equal(1)})}),describe("Test observable bindings against collections",function(){var u,s,p,d,h,f,b,m;return p=function(e){function o(){return m=o.__super__.constructor.apply(this,arguments)}return t(o,e),o.prototype.url="#layout-template",o.prototype.defaults={collection_a1:function(){return new n},collection_a2:function(){return new n}},o.prototype.observables={selected_number:1,selected_collection:function(){return 1===this.selected_number()?this.collection_a1:this.collection_a2}},o}(Falcon.View),s=$("				<template id='layout-template'>					<ul class='collection_list' data-bind='foreach: $view.selected_collection'><li>An Item</li></ul>				</template>			"),f=null,b=ko.observable(),u=null,d=h=null,before(function(){return o.append(s),c=sinon.spy(a,"init"),i=sinon.spy(a,"update"),l(b)}),beforeEach(function(){return f=new p,b(f),u=$(".collection_list")}),afterEach(function(){return e.empty(),c.reset(),i.reset()}),after(function(){return e.remove(),s.remove(),c.restore(),i.restore()}),it("Should properly update if collection is switched to another with same update count",function(){return expect(c).to.have.been.called,expect(i).to.have.been.called,expect(c.callCount).to.equal(1),expect(i.callCount).to.equal(1),c.reset(),i.reset(),f.collection_a1.fill([new r,new r]),f.collection_a2.fill([new r,new r,new r,new r,new r]),expect(c).to.have.not.been.called,expect(i).to.have.been.called,expect(i.callCount).to.equal(1),expect(u.children().length).to.equal(2),c.reset(),i.reset(),f.selected_number(2),expect(c).to.have.not.been.called,expect(i).to.have.been.called,expect(i.callCount).to.equal(1),expect(u.children().length).to.equal(5),c.reset(),i.reset(),f.selected_number(1),expect(c).to.have.not.been.called,expect(i).to.have.been.called,expect(i.callCount).to.equal(1),expect(u.children().length).to.equal(2)})})}),describe("Test updated options binding",function(){}),describe("Test log binding",function(){})})}).call(this);